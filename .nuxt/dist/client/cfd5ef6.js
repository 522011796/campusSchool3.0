(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1261:function(t,e,o){"use strict";o.r(e);var l={name:"LayoutTb",data:function(){return{showTab:!0,showTag:!1}},mounted:function(){this.showTab=void 0!==this.$slots.tab},created:function(){},methods:{}},r=o(10),component=Object(r.a)(l,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"color-muted font-size-12 padding-top-5 animated fadeInUp"},[t.showTag?o("span",{staticClass:"layout-menu-title"},[t._t("tag")],2):t._e()]),t._v(" "),t.showTab?o("div",{staticClass:"layout-top-tab margin-top-5"},[t._t("tab")],2):t._e(),t._v(" "),o("div",{staticClass:"layout-bottom-tab margin-top-10"},[t._t("content")],2)])}),[],!1,null,null,null);e.default=component.exports},1263:function(t,e,o){var content=o(1272);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(31).default)("6a31cf35",content,!0,{sourceMap:!1})},1268:function(t,e,o){"use strict";o.r(e);o(65);var l=o(76),r=(o(6),o(7),{mixins:[l.a],props:{title:{default:"信息",type:String},visible:{default:!1,type:Boolean},direction:{default:"rtl",type:String},hideFooter:{default:!1,type:Boolean},loading:{default:!1,type:Boolean},size:{defalult:"30%",type:String},action:{default:"",type:String},downloadFile:{default:"",type:String},accept:{default:"",type:String},data:{default:function(){return{}},type:Object},process:{default:"",type:String},result:{default:function(){return{}||[]},type:[Object,Array]},setBefore:{default:!1,type:Boolean}},computed:{drawer_:{get:function(){return this.visible},set:function(t){this.$emit("changeDrawer",t)}}},data:function(){return{drawer:!1,dialogNormalVisible:!1,footer:!1,header:!1,drawerLoading:!1}},mounted:function(){this.dialogNormalVisible=this.visible,this.footer=void 0!==this.$slots.footer,this.header=void 0!==this.$slots.title},created:function(){},methods:{handleClose:function(data){this.footer?this.handleCancel():this.$emit("right-close",data)},handleOk:function(data){this.$emit("ok",data)},handleCancel:function(data){this.$emit("cancel",data)},download:function(t){window.open(this.downloadFile,"_self")},handleAvatarSuccess:function(t,e){this.$emit("success",t,e)},handleAvatarError:function(t,e){this.$emit("error",t,e)},handleAvatarBefore:function(t){this.setBefore&&(this.data.fileName=t.name)}}}),n=(o(1271),o(10)),component=Object(n.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("el-drawer",{staticStyle:{"margin-top":"60px"},attrs:{tabindex:"0","custom-class":"drawer-normal-drawer",visible:t.drawer_,direction:t.direction,wrapperClosable:!0,"show-close":!1,"modal-append-to-body":!1,size:t.size},on:{"update:visible":function(e){t.drawer_=e}}},[o("div",{staticClass:"drawer-normal-title",attrs:{slot:"title"},slot:"title"},[o("span",{attrs:{tabindex:"1"}}),t._v(" "),t.header?t._e():o("el-row",[o("el-col",{attrs:{span:12}},[o("div",{staticClass:"drawer-normal-header"},[o("span",{staticClass:"title"},[t._v(t._s(t.title))])])]),t._v(" "),o("el-col",{attrs:{span:12}},[o("div",{staticClass:"drawer-normal-close text-right color-disabeld font-size-14"},[o("i",{staticClass:"fa fa-close",on:{click:t.handleClose}})])])],1)],1),t._v(" "),o("div",{staticClass:"drawer-normal-body",style:0==t.hideFooter?t.drawHeight:""},[o("div",[o("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:t.download}},[o("i",{staticClass:"fa fa-download"}),t._v("\n          "+t._s(t.$t("下载模版"))+"\n        ")]),t._v(" "),o("span",{staticClass:"font-size-12 color-muted"},[t._v("("+t._s(t.$t("支持Excel2003或者Excel2007"))+")")])],1),t._v(" "),o("div",{staticClass:"margin-top-10"},[o("div",{staticClass:"padding-tb-5 color-muted"},[o("span",[t._v(t._s(t.$t("文件上传")))])]),t._v(" "),o("div",[o("el-upload",{staticClass:"custom-upload",attrs:{drag:"",action:t.action,accept:t.accept,data:t.data,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"on-error":t.handleAvatarError,"before-upload":t.handleAvatarBefore}},[o("i",{staticClass:"el-icon-upload"}),t._v(" "),o("div",{staticClass:"el-upload__text"},[t._v(t._s(t.$t("将文件拖到此处，或"))),o("em",[t._v(t._s(t.$t("点击上传")))])])])],1),t._v(" "),o("div",{staticClass:"padding-tb-5 color-muted"},[o("span",[t._v(t._s(t.$t("上传结果")))])]),t._v(" "),o("div",[o("el-timeline",[o("el-timeline-item",[o("div",{staticClass:"color-muted font-size-12"},[o("span",[t._v(t._s(t.$t("上传进度")))])]),t._v(" "),o("div",{staticClass:"color-disabeld font-size-12 margin-top-5"},[""!=t.process?o("span",[t._v(t._s(t.process))]):o("span",[t._v(t._s(t.$t("文件未上传")))])])]),t._v(" "),o("el-timeline-item",[o("div",{staticClass:"color-muted font-size-12"},[o("span",[t._v(t._s(t.$t("上传结果")))])]),t._v(" "),o("div",{staticClass:"color-disabeld font-size-12 margin-top-5"},[Object.keys(t.result).length>0?o("div",t._l(t.result,(function(e,l){return o("div",{key:l},[o("span",[t._v(t._s(e))])])})),0):o("span",[t._v(t._s(t.$t("暂无数据")))])])])],1)],1)])]),t._v(" "),0==t.hideFooter?o("div",{staticClass:"drawer-normal-footer",attrs:{"hide-footer":t.hideFooter}},[o("el-button",{attrs:{size:"small"},on:{click:t.handleCancel}},[t._v(t._s(t.$t("取消")))]),t._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){0==t.loading&&t.handleOk()}}},[t.loading?o("i",{staticClass:"el-icon-loading"}):t._e(),t._v("\n        "+t._s(t.$t("确定"))+"\n      ")])],1):t._e()])],1)}),[],!1,null,"5cbdbb54",null);e.default=component.exports},1271:function(t,e,o){"use strict";var l=o(1263);o.n(l).a},1272:function(t,e,o){(e=o(30)(!1)).push([t.i,"",""]),t.exports=e},1339:function(t,e,o){var content=o(1589);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(31).default)("a85df900",content,!0,{sourceMap:!1})},1588:function(t,e,o){"use strict";var l=o(1339);o.n(l).a},1589:function(t,e,o){(e=o(30)(!1)).push([t.i,".container[data-v-f1ecaeb0]{padding:10px 15px}.title-block-tag[data-v-f1ecaeb0]{display:inline-block;height:20px;width:3px;background:#e6a23c;font-weight:700;border-radius:3px}.title-block-text[data-v-f1ecaeb0]{font-weight:700;position:relative;top:-5px}.block-item-bg[data-v-f1ecaeb0]{border-radius:5px;background:#fff;padding:10px}",""]),t.exports=e},1964:function(t,e,o){"use strict";o.r(e);o(360),o(106),o(710),o(107);var l=o(76),r=o(1261),n=o(1257),c=o(234),d=o(235),f=o(1260),h=o(1268),m=o(7),v=o(6),_=o(236),w=o(86),y=o.n(w),C={data:function(){return{rules:{deptName:[{required:!0,message:this.$t("请输入名称"),trigger:"blur"},{validator:y.a.FormValidate.Form().validatenall1_20Reg,trigger:"blur"}]}}}},$={mixins:[l.a,C],components:{DrawerLayoutRight:_.default,LayoutTb:r.default,MyInputButton:n.default,MyPagination:c.default,DialogNormal:d.default,MyNormalDialog:f.default,DrawerRight:h.default},data:function(){return{drawerVisible:!1,drawerLoading:!1,visibleConfim:!1,dialogLoading:!1,refreshTeacherStatus:!1,tableData:[],searchKey:"",teacherArray:[],approverUsers:[],errorTeacher:"",form:{id:"",name:"",no:"",oldRoleName:"",deptId:"",roleName:"",userList:""}}},created:function(){this.init()},methods:{init:function(){var t=this,e={page:this.page,num:this.num,departmentName:this.searchKey};this.$axios.get(m.a.organize_role_page,{params:e}).then((function(e){if(e.data.data){for(var o=[],i=0;i<e.data.data.list.length;i++)""!=e.data.data.list[i].department_path&&o.push(e.data.data.list[i]);t.tableData=o,t.total=e.data.data.totalCount,t.num=e.data.data.num,t.page=e.data.data.currentPage}}))},addInitData:function(t){this.form={name:t.department_name,no:t.department_no,deptId:t.id},this.drawerVisible=!0},editInfo:function(t,e,o){for(var l=e.user_id?e.user_id.split(","):[],r=[],i=0;i<l.length;i++)r.push({user_id:l[i]});this.form={id:o.id,no:o.department_no,name:o.department_name,deptId:o.id,oldRoleName:e.role_name,roleName:e.role_name,userList:r},this.approverUsers=r,this.teacherArray=r,this.drawerVisible=!0},delInfo:function(t,e,o){this.form.deptId=o.id,this.form.roleName=e.role_name,this.visibleConfim=!0},sizeChange:function(t){this.page=1,this.num=t,this.init()},currentPage:function(t){this.page=t,this.init()},jumpPage:function(data){this.page=data,this.init()},search:function(data){this.searchKey=data.input,this.page=1,this.init()},handleShowTeacher:function(t){var e=this;setTimeout((function(){1==t&&e.$refs.popverTeacherRef._handleOpen()}),800)},handleSelUser:function(data,t){1==t&&(this.teacherArray=data),this.approverUsers=this.teacherArray},loadingShow:function(t){var e=this,o=null;switch(clearTimeout(o),t){case 1:this.refreshTeacherStatus=!0,o=setTimeout((function(){e.refreshTeacherStatus=!1,clearTimeout(o)}),1e3)}},closeDrawerDialog:function(t){this.closeDialog(),this.drawerVisible=!1},cancelDrawDialog:function(){this.drawerVisible=!1},closeDialog:function(t){this.form={id:"",name:"",no:"",oldRoleName:"",deptId:"",roleName:"",userList:""},this.errorTeacher="",this.teacherArray=[],this.approverUsers=[],this.$refs.form&&this.$refs.form.resetFields()},handleOkChange:function(data){var t=this;this.dialogLoading=!0;var e,o={deptId:this.form.deptId,roleName:this.form.roleName};e=m.a.organize_role_del,o=this.$qs.stringify(o),this.$axios.post(e,o).then((function(e){200==e.data.code?(t.init(),Object(v.b)(e.data.desc)):Object(v.a)(e.data.desc),t.visibleConfim=!1,t.dialogLoading=!1}))},handleCancelChange:function(data){this.visibleConfim=!1},okDrawDialog:function(t){var e=this;this.errorTeacher="",this.$refs.form.validate((function(t){if(t){var o=[];if(0==e.teacherArray.length)return void(e.errorTeacher=e.$t("请选择老师"));for(var i=0;i<e.teacherArray.length;i++)o.push(e.teacherArray[i].user_id);var l={oldRoleName:"",deptId:e.form.deptId,roleName:e.form.roleName,userIds:o.join()};""!=e.form.id&&(l.oldRoleName=e.form.oldRoleName),e.dialogLoading=!0,l=e.$qs.stringify(l),e.$axios.post(m.a.organize_role_save,l,{loading:!1}).then((function(t){200==t.data.code?(e.drawerForm=!1,e.init(),e.closeDialog(),Object(v.b)(t.data.desc)):Object(v.a)(t.data.desc),e.dialogLoading=!1,e.drawerVisible=!1}))}}))}}},x=(o(1588),o(10)),component=Object(x.a)($,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("layout-tb",[o("template",{slot:"tag"},[t._v("部门信息")]),t._v(" "),o("div",{attrs:{slot:"tab"},slot:"tab"},[o("el-row",[o("el-col",{staticClass:"text-right",attrs:{span:24}},[o("MyInputButton",{attrs:{size:"small",plain:"","width-class":"width: 150px",type:"success",clearable:!0,placeholder:t.$t("部门名称")},on:{click:t.search}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"content"},slot:"content"},[o("el-table",{ref:"refTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-class-name":"custom-table-cell-bg",size:"medium","row-key":"id","max-height":t.tableHeight.height}},[o("el-table-column",{attrs:{align:"center",prop:"department_no",label:t.$t("编号")}}),t._v(" "),o("el-table-column",{attrs:{align:"center",prop:"department_name",label:t.$t("名称")}}),t._v(" "),o("el-table-column",{attrs:{align:"center",prop:"department_no",label:t.$t("角色管理")},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.userList&&0==e.row.userList.length?o("span",[t._v("--")]):t._e(),t._v(" "),t._l(e.row.userList,(function(l,r){return e.row.userList.length>0?o("div",{key:r,staticClass:"color-text-default moon-content-text-ellipsis-class"},[o("label",[t._v(t._s(l.role_name))]),t._v(" "),o("el-popover",{attrs:{placement:"left",width:"150",trigger:"click"}},[o("div",{staticStyle:{"max-height":"300px","overflow-y":"auto"}},[""!=l.real_name&&null!=l.real_name?t._l(l.real_name.split(","),(function(e,l){return o("div",{key:l,staticClass:"margin-bottom-5"},[o("el-tag",{attrs:{size:"mini"}},[o("div",{staticClass:"moon-content-text-ellipsis-class",staticStyle:{"max-width":"100px"}},[t._v(t._s(e))])])],1)})):t._e()],2),t._v(" "),o("span",{staticClass:"color-muted font-size-12 moon-content-text-ellipsis-class",staticStyle:{display:"inline-block","max-width":"100px",position:"relative",top:"7px",cursor:"default"},attrs:{slot:"reference"},slot:"reference"},[null==l.real_name?o("label"):o("label",[t._v("("+t._s(l.real_name)+")")])])]),t._v(" "),o("span",{on:{click:function(o){return t.editInfo(o,l,e.row)}}},[o("i",{staticClass:"fa fa-edit color-success"})]),t._v(" "),o("span",{on:{click:function(o){return t.delInfo(o,l,e.row)}}},[o("i",{staticClass:"fa fa-trash color-danger"})])],1):t._e()}))]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("i",{staticClass:"fa fa-plus-circle margin-right-5 color-success",on:{click:function(o){return t.addInitData(e.row)}}})]}}])})],1),t._v(" "),o("div",{staticClass:"layout-right-footer text-right"},[o("my-pagination",{staticClass:"layout-pagination",attrs:{total:t.total,"current-page":t.page,"page-size":t.num},on:{currentPage:t.currentPage,sizeChange:t.sizeChange,jumpChange:t.jumpPage}})],1)],1)],2),t._v(" "),o("drawer-layout-right",{attrs:{visible:t.drawerVisible,size:"600px",title:t.$t("角色设置")},on:{changeDrawer:t.closeDrawerDialog,"right-close":t.closeDrawerDialog}},[o("div",{attrs:{slot:"content"},slot:"content"},[o("div",[o("div",{staticClass:"color-muted margin-top-5"},[o("span",[o("label",{staticClass:"title-block-tag"}),t._v(" "),o("label",{staticClass:"title-block-text color-warning"},[t._v(t._s(t.$t("服务设置")))])])]),t._v(" "),o("div",{staticClass:"block-item-bg font-size-12"},[o("el-form",{attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:t.$t("部门编号")}},[o("span",{staticClass:"color-muted"},[t._v(t._s(t.form.no))])]),t._v(" "),o("el-form-item",{attrs:{label:t.$t("部门名称")}},[o("span",{staticClass:"color-muted"},[t._v(t._s(t.form.name))])])],1)],1)]),t._v(" "),o("div",{staticClass:"margin-top-10"},[o("div",{staticClass:"color-muted"},[o("span",[o("label",{staticClass:"title-block-tag"}),t._v(" "),o("label",{staticClass:"title-block-text color-warning"},[t._v(t._s(t.$t("角色设置")))])])]),t._v(" "),o("div",{staticClass:"block-item-bg font-size-12"},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[o("el-form-item",{attrs:{label:t.$t("角色名称"),prop:"roleName"}},[o("el-input",{staticClass:"width-300",attrs:{size:"small"},model:{value:t.form.roleName,callback:function(e){t.$set(t.form,"roleName",e)},expression:"form.roleName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:t.$t("选择老师")}},[o("el-popover",{attrs:{"popper-class":"custom-popper-class-form",placement:"left",width:"700",trigger:"click"},on:{show:function(e){return t.handleShowTeacher(1)}}},[o("div",[o("teacher-tree-and-list",{ref:"popverTeacherRef",attrs:{"user-type":"user","sel-arr":t.teacherArray,"set-type":"check"},on:{select:function(e){return t.handleSelUser(e,1)}}})],1),t._v(" "),o("el-button",{attrs:{slot:"reference",type:"success",plain:"",size:"small"},on:{click:function(e){return t.loadingShow(1)}},slot:"reference"},[1==t.refreshTeacherStatus?o("i",{staticClass:"fa fa-refresh fa-spin"}):t._e(),t._v("\n                    "+t._s(t.$t("添加老师"))+"\n                  ")])],1),t._v(" "),o("span",[t._v(t._s(t.$t("人数"))+": "+t._s(t.approverUsers.length))]),t._v(" "),o("div",[o("span",{staticClass:"color-danger font-size-12"},[t._v(t._s(t.errorTeacher))])])],1)],1)],1)])]),t._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:t.cancelDrawDialog}},[t._v(t._s(t.$t("取消")))]),t._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.okDrawDialog()}}},[t.dialogLoading?o("i",{staticClass:"el-icon-loading"}):t._e(),t._v("\n          "+t._s(t.$t("确定"))+"\n        ")])],1)]),t._v(" "),o("my-normal-dialog",{attrs:{visible:t.visibleConfim,loading:t.dialogLoading,title:"提示",content:"确认需要删除该信息？"},on:{"update:visible":function(e){t.visibleConfim=e},"ok-click":t.handleOkChange,"cancel-click":t.handleCancelChange,close:t.closeDialog}})],1)}),[],!1,null,"f1ecaeb0",null);e.default=component.exports;installComponents(component,{MyInputButton:o(1257).default,MyPagination:o(234).default,LayoutTb:o(1261).default,TeacherTreeAndList:o(1285).default,DrawerLayoutRight:o(236).default,MyNormalDialog:o(1260).default})}}]);