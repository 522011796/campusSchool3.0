(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{1477:function(e,t,o){var content=o(1858);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(31).default)("3fd6b49c",content,!0,{sourceMap:!1})},1857:function(e,t,o){"use strict";var l=o(1477);o.n(l).a},1858:function(e,t,o){(t=o(30)(!1)).push([e.i,"",""]),e.exports=t},2093:function(e,t,o){"use strict";o.r(t);o(109),o(360),o(108),o(65),o(110);var l=o(234),n=o(76),r=o(7),c=o(6),d=o(1261),h=o(1256),f=o(1273),m=o(1258),v=o(1257),_=o(235),y=o(1260),C=o(1262),w=o(1537),k={mixins:[n.a,w.a],components:{MyPagination:l.default,LayoutTb:d.default,MySelect:h.default,MyUserType:f.default,MyDatePicker:m.default,MyInputButton:v.default,DialogNormal:_.default,MyNormalDialog:y.default,MyElTree:C.default},data:function(){return{tableData:[],searchDate:[],typeList:[],searchKey:"",visible:!1,modalVisible:!1,dialogLoading:!1,visibleConfim:!1,mutiDeleteLoading:!1,editMutiStatus:!1,clearTime:"",action:"",subTitle:"",weightStatus:[],defaultCheckedKeys:[],deviceList:[],searchCollege:"",searchMajor:"",searchGrade:"",searchClass:"",form:{id:"",type:"",name:"",weight:"",area:"",areaData:[]}}},created:function(){this.init(),this.initWeight()},methods:{init:function(){var e=this,t={page:this.page,num:this.num,checkType:2,orderAttr:"check_item",orderAsc:!1};t.collegeId=this.searchCollege,t.majorId=this.searchMajor,t.grade=this.searchGrade,t.classId=this.searchClass,this.$axios.get(r.a.housework_query_check_item_page,{params:t}).then((function(t){t.data.data&&(e.tableData=t.data.data.list,e.total=t.data.data.totalCount,e.num=t.data.data.num,e.page=t.data.data.currentPage)}))},getRowKeys:function(e){return e.id},initWeight:function(){this.weightStatus=[];for(var i=0;i<9;i++)this.weightStatus.push({label:i+1,value:i+1})},addInfo:function(){this.modalVisible=!0},editMutiInfo:function(){this.editMutiStatus=!0,this.modalVisible=!0},deleteMutiInfo:function(){for(var e=this,t=[],i=0;i<this.deviceList.length;i++)t.push(this.deviceList[i].id);var o={idSet:t.join(),reset:!0};o=this.$qs.stringify(o),this.mutiDeleteLoading=!0,this.$axios.post(r.a.delete_batch_object,o).then((function(t){200==t.data.code?(e.init(),e.deviceList=[],e.$refs.refTable.clearSelection(),Object(c.b)(t.data.desc)):Object(c.a)(t.data.desc),e.mutiDeleteLoading=!1}))},search:function(data){this.searchKey=data.input,this.page=1,this.init()},sizeChange:function(e){this.page=1,this.num=e,this.init()},currentPage:function(e){this.page=e,this.init()},jumpPage:function(data){this.page=data,this.init()},nodeClick:function(data){this.searchCollege="",this.searchMajor="",this.searchGrade="",this.searchClass="",this.searchBuild="",this.searchFloor="",1==data.unit?this.searchCollege=data.id:2==data.unit?(this.searchCollege=data.college_id,this.searchMajor=data.id):3==data.unit?(this.searchMajor=data.major_id,this.searchGrade=data.grade):4==data.unit&&(this.searchClass=data.id),this.page=1,this.init()},handleSelect:function(data,e){switch(e){case 1:this.form.area=data;break;case 2:this.form.weight=data}},areaTypeInfo:function(e){return Object(c.d)(e)},editInfo:function(e){this.form={id:e.id,type:"",name:e.check_item,weight:e.weight,area:""+e.scope_type},this.modalVisible=!0},deleteInfo:function(e){this.form.id=e.id,this.subTitle=e.check_item,this.visibleConfim=!0},handleOkChange:function(data){var e=this;this.dialogLoading=!0;var t,o={id:this.form.id};t=r.a.housework_query_check_item_del,o=this.$qs.stringify(o),this.$axios.post(t,o).then((function(t){200==t.data.code?(e.init(),Object(c.b)(t.data.desc)):Object(c.a)(t.data.desc),e.visibleConfim=!1,e.dialogLoading=!1}))},handleCancelChange:function(data){this.visibleConfim=!1},cancelDialog:function(){this.modalVisible=!1},closeDialog:function(e){var t=this;(this.form={id:"",type:"",name:"",weight:"",area:"",areaData:[]},this.subTitle="",this.editMutiStatus=!1,this.$refs.areeTree)&&this.$refs.areeTree.$refs.tree.getCheckedNodes().forEach((function(e){t.$nextTick((function(){t.$refs.areeTree.$refs.tree.setChecked(e.id,!1,!0)}))}));this.$refs.form&&this.$refs.form.resetFields()},okDialog:function(e){var t=this,o="",l=[];this.$refs.form.validate((function(e){if(e){if(""==t.form.id&&0==t.editMutiStatus&&0==(l=t.setAreaChildren(t.$refs.areeTree.$refs.tree.getCheckedNodes())).length)return void Object(c.c)(t.$t("请选择范围"));t.dialogLoading=!0;var n={checkType:2,checkItem:3==t.form.area?t.$t("空床"):t.form.name,scopeType:t.form.area,weight:t.form.weight};if(""!=t.form.id)o=r.a.housework_query_check_item_edit,n.id=t.form.id;else if(1==t.editMutiStatus){o=r.a.edit_batch_object;for(var d=[],i=0;i<t.deviceList.length;i++)d.push(t.deviceList[i].id);n.idSet=d.join()}else o=r.a.housework_query_check_item_save,n.classIdSet=l.join();n=t.$qs.stringify(n),t.$axios.post(o,n,{loading:!1}).then((function(e){200==e.data.code?(t.modalVisible=!1,t.init(),t.deviceList=[],t.$refs.refTable.clearSelection(),Object(c.b)(e.data.desc)):Object(c.a)(e.data.desc),t.dialogLoading=!1}))}}))},setAreaChildren:function(e){var t=this,o=[];return e&&e.length>0&&e.map((function(e,l){4==e.unit&&o.push(e.id),null!=e.children&&e.children.length>0&&t.setAreaChildren(e.children)})),o},handleSelectionChange:function(data){this.deviceList=data}}},$=(o(1857),o(10)),component=Object($.a)(k,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("layout-lr",[o("div",{attrs:{slot:"left"},slot:"left"},[o("div",{staticClass:"color-muted font-size-12 padding-tb-5 margin-top-10"},[o("span",{staticClass:"layout-left-menu-title"},[e._v("项目管理")])]),e._v(" "),o("my-el-tree",{attrs:{type:"1","sub-type":"4"},on:{"node-click":e.nodeClick,"all-click":e.nodeClick}})],1),e._v(" "),o("div",{attrs:{slot:"right"},slot:"right"},[o("div",{staticClass:"layout-top-tab margin-top-5"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addInfo(t)}}},[e._v(e._s(e.$t("添加项目")))]),e._v(" "),o("el-button",{attrs:{size:"small",type:"default",disabled:e.deviceList.length<=0,loading:e.mutiDeleteLoading,icon:"el-icon-delete"},on:{click:function(t){return e.deleteMutiInfo(t)}}},[e._v(e._s(e.$t("批量删除")))]),e._v(" "),o("el-button",{attrs:{size:"small",type:"default",disabled:e.deviceList.length<=0,icon:"el-icon-delete"},on:{click:function(t){return e.editMutiInfo(t)}}},[e._v(e._s(e.$t("批量修改")))])],1)],1)],1),e._v(" "),o("div",{staticClass:"margin-top-10"},[o("el-table",{ref:"refTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"custom-table-cell-bg",size:"medium","row-key":"id","row-key":e.getRowKeys,"max-height":e.tableHeight2.height},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{"reserve-selection":!0,type:"selection",align:"center",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:e.$t("范围")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[o("div",{staticClass:"text-center"},[e._v("\n                  "+e._s(t.row.college_name)+"-"+e._s(t.row.major_name)+"-"+e._s(t.row.class_name)+"\n                ")]),e._v(" "),o("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[e._v("\n                  "+e._s(t.row.college_name)+"-"+e._s(t.row.major_name)+"-"+e._s(t.row.class_name)+"\n                ")])])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:e.$t("区域")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[o("div",{staticClass:"text-center"},[e._v("\n                  "+e._s(e.areaTypeInfo(t.row.scope_type))+"\n                ")]),e._v(" "),o("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[e._v("\n                  "+e._s(e.areaTypeInfo(t.row.scope_type))+"\n                ")])])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:e.$t("项目")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[o("div",{staticClass:"text-center"},[e._v("\n                  "+e._s(t.row.check_item)+"\n                ")]),e._v(" "),o("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[e._v("\n                  "+e._s(t.row.check_item)+"\n                ")])])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",prop:"weight",label:e.$t("权重")}}),e._v(" "),o("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"fa fa-edit color-grand margin-right-5",on:{click:function(o){return e.editInfo(t.row)}}}),e._v(" "),o("i",{staticClass:"fa fa-trash color-danger",on:{click:function(o){return e.deleteInfo(t.row)}}})]}}])})],1),e._v(" "),o("div",{staticClass:"layout-right-footer text-right"},[o("my-pagination",{staticClass:"layout-pagination",attrs:{total:e.total,"current-page":e.page,"page-size":e.num},on:{currentPage:e.currentPage,sizeChange:e.sizeChange,jumpChange:e.jumpPage}})],1)],1)])]),e._v(" "),o("dialog-normal",{attrs:{visible:e.modalVisible,title:e.$t("项目设置")},on:{close:e.closeDialog,"right-close":e.cancelDialog}},[o("div",{staticClass:"margin-top-10"},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"140px"}},[o("el-form-item",{attrs:{label:e.$t("区域"),prop:"area"}},[o("my-select",{attrs:{"sel-value":e.form.area,options:e.filterOtherAreaStatus,"width-style":"260"},on:{change:function(t){return e.handleSelect(t,1)}}})],1),e._v(" "),"3"!=e.form.area?o("el-form-item",{attrs:{label:e.$t("名称"),prop:"name"}},[o("el-input",{staticClass:"width-260",model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:e.$t("权重"),prop:"weight"}},[o("my-select",{attrs:{"sel-value":e.form.weight,options:e.weightStatus,"width-style":"260"},on:{change:function(t){return e.handleSelect(t,2)}}})],1),e._v(" "),""==e.form.id&&0==e.editMutiStatus?o("el-form-item",{attrs:{label:e.$t("范围"),prop:"areaData"}},[o("el-card",{staticClass:"width-260",staticStyle:{height:"200px","overflow-y":"auto"},attrs:{shadow:"naver","body-style":{padding:"10px"}}},[o("my-el-tree",{ref:"areeTree",attrs:{defaultCheckedKeys:e.defaultCheckedKeys,type:"1","sub-type":"4","show-checkbox":!0}})],1)],1):e._e()],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:e.cancelDialog}},[e._v(e._s(e.$t("取消")))]),e._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){0==e.dialogLoading&&e.okDialog()}}},[e.dialogLoading?o("i",{staticClass:"el-icon-loading"}):e._e(),e._v("\n        "+e._s(e.$t("确定"))+"\n      ")])],1)]),e._v(" "),o("my-normal-dialog",{attrs:{visible:e.visibleConfim,loading:e.dialogLoading,title:"提示",detail:e.subTitle,content:"确认需要删除该信息？"},on:{"update:visible":function(t){e.visibleConfim=t},"ok-click":e.handleOkChange,"cancel-click":e.handleCancelChange,close:e.closeDialog}})],1)}),[],!1,null,"6738db97",null);t.default=component.exports;installComponents(component,{MyElTree:o(1262).default,MyPagination:o(234).default,LayoutLr:o(1264).default,MySelect:o(1256).default,DialogNormal:o(235).default,MyNormalDialog:o(1260).default})}}]);