(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1256:function(t,e,l){"use strict";l.r(e);l(179);var o=l(6),n={name:"mySelect",props:{placeholder:{default:"",type:String},selValue:{default:"",type:[String,Number,Boolean]},options:{default:function(){return[]},type:Array},size:{defalult:"medium",validate:function(t){return Object(o.D)(t,["large","medium","small","mini"])}},clearable:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean},filterable:{default:!1,type:Boolean},remote:{default:!1,type:Boolean},loading:{default:!1,type:Boolean},group:{default:!1,type:Boolean},remoteMethod:{default:function(data){return data},type:Function},widthStyle:{default:"",type:[String,Number]}},computed:{selectModel:function(){this.value=this.selValue},setPlaceholder:function(){this.selectPlaceholder=this.placeholder?this.placeholder:this.$t("请选择")},setWidth:function(){this.widthStyle&&(this.width={width:this.widthStyle+"px"})}},data:function(){return{selectPlaceholder:"",value:"",width:""}},methods:{handleChange:function(data){this.$emit("change",data)}}},r=l(10),component=Object(r.a)(n,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("el-select",t._b({style:t.width,attrs:{setPlaceholder:t.setPlaceholder,placeholder:t.selectPlaceholder,size:t.size,clearable:t.clearable,disabled:t.disabled,filterable:t.filterable,loading:t.loading,remote:t.remote,"remote-method":t.remoteMethod,setWidth:t.setWidth},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},"el-select",t.selectModel,!1),[0==t.group?t._l(t.options,(function(t,e){return l("el-option",{key:e,attrs:{label:t.label,value:t.value,disabled:t.disabled}})})):t._e(),t._v(" "),1==t.group?t._l(t.options,(function(e){return l("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)})):t._e()],2)],1)}),[],!1,null,null,null);e.default=component.exports},1261:function(t,e,l){"use strict";l.r(e);var o={name:"LayoutTb",data:function(){return{showTab:!0,showTag:!1}},mounted:function(){this.showTab=void 0!==this.$slots.tab},created:function(){},methods:{}},n=l(10),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("div",{staticClass:"color-muted font-size-12 padding-top-5 animated fadeInUp"},[t.showTag?l("span",{staticClass:"layout-menu-title"},[t._t("tag")],2):t._e()]),t._v(" "),t.showTab?l("div",{staticClass:"layout-top-tab margin-top-5"},[t._t("tab")],2):t._e(),t._v(" "),l("div",{staticClass:"layout-bottom-tab margin-top-10"},[t._t("content")],2)])}),[],!1,null,null,null);e.default=component.exports},1299:function(t,e,l){var content=l(1323);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,l(31).default)("6c30d5b0",content,!0,{sourceMap:!1})},1316:function(t,e,l){"use strict";l.r(e);l(179);var o={name:"myFormAuditType",props:{itemIndex:{type:[Number,String],default:0},customUserStatus:{type:Boolean,default:!1}},computed:{},data:function(){return{popVisible:!1,value:""}},methods:{addPop:function(){this.popVisible=!0},selAuditType:function(t,e,l){this.popVisible=!1,this.$emit("click",e,l,parseInt(this.itemIndex))},showPop:function(){this.$emit("showPop")}}},n=(l(1322),l(10)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("el-popover",{attrs:{placement:"right",width:"100",trigger:"hover"},on:{show:t.showPop},model:{value:t.popVisible,callback:function(e){t.popVisible=e},expression:"popVisible"}},[l("div",{staticClass:"font-size-12"},[l("div",{},[l("div",{staticClass:"color-muted"},[l("span",[t._v(t._s(t.$t("审批节点")))])]),t._v(" "),l("div",{staticClass:"margin-left-5"},[l("div",{staticClass:"flow-item-child-block padding-tb-5",on:{click:function(e){return t.selAuditType(e,1,"audit")}}},[l("i",{staticClass:"fa fa-user"}),t._v(" "),l("span",[t._v(t._s(t.$t("固定人审批")))])]),t._v(" "),l("div",{staticClass:"flow-item-child-block padding-tb-5",on:{click:function(e){return t.selAuditType(e,2,"audit")}}},[l("i",{staticClass:"fa fa-cog"}),t._v(" "),l("span",[t._v(t._s(t.$t("系统角色审批")))])]),t._v(" "),0==t.customUserStatus?l("div",{staticClass:"flow-item-child-block padding-tb-5",on:{click:function(e){return t.selAuditType(e,3,"audit")}}},[l("i",{staticClass:"fa fa-flag"}),t._v(" "),l("span",[t._v(t._s(t.$t("发起人自选审批")))])]):t._e()])]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("div",{staticClass:"color-muted"},[l("span",[t._v(t._s(t.$t("抄送节点")))])]),t._v(" "),l("div",{staticClass:"margin-left-5"},[l("div",{staticClass:"flow-item-child-block padding-tb-5",on:{click:function(e){return t.selAuditType(e,4,"send")}}},[l("i",{staticClass:"fa fa-user"}),t._v(" "),l("span",[t._v(t._s(t.$t("抄送给固定人")))])]),t._v(" "),l("div",{staticClass:"flow-item-child-block padding-tb-5",on:{click:function(e){return t.selAuditType(e,5,"send")}}},[l("i",{staticClass:"fa fa-cog"}),t._v(" "),l("span",[t._v(t._s(t.$t("抄送给系统角色")))])])])])]),t._v(" "),l("span",{staticClass:"flow-item-line-block",attrs:{slot:"reference"},slot:"reference"},[l("i",{staticClass:"fa fa-plus-circle color-muted",staticStyle:{"font-size":"25px"},on:{click:t.addPop}})])])],1)}),[],!1,null,"129ebc32",null);e.default=component.exports},1322:function(t,e,l){"use strict";var o=l(1299);l.n(o).a},1323:function(t,e,l){(e=l(30)(!1)).push([t.i,'.flow-item-line-block[data-v-129ebc32]{position:relative}.flow-item-line-block[data-v-129ebc32]:after{top:-24px}.flow-item-line-block[data-v-129ebc32]:after,.flow-item-line-block[data-v-129ebc32]:before{content:"";width:1px;height:15px;position:absolute;left:10px;background:#dcdfe6}.flow-item-line-block[data-v-129ebc32]:before{top:19px}.flow-item-child-block[data-v-129ebc32]:hover{background:#eee}',""]),t.exports=e},1394:function(t,e,l){var content=l(1696);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,l(31).default)("e273c436",content,!0,{sourceMap:!1})},1395:function(t,e,l){var content=l(1698);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,l(31).default)("6637976d",content,!0,{sourceMap:!1})},1545:function(t,e,l){"use strict";l.r(e);l(709),l(107),l(53);var o=l(9),n=l(76),r=(l(7),l(6)),c=l(1256),d={name:"myProcessFlow",components:{MyFormAuditType:l(1316).default,MySelect:c.default},mixins:[n.a],props:{formId:Object,flowData:{default:function(){return[]},type:Array},form:{default:function(){return{auditType:"",name:"",allowBack:!1,urge:!1,autoAudit:!1,merge:!1}},type:Object}},computed:{},data:function(){return{checkRight1All:!1,checkRight2All:!1,popVisible:!1,refreshTeacherStatus:!1,activeName:"only",flowCustonUserStatus:!1,flowDetailIndex:"",flowDetailData:{},approverUsers:[],formFieldList:[],roleGroup:{},auditFlowType:[{label:this.$t("固定人审批"),text:this.$t("固定人审批"),value:1},{label:this.$t("系统角色审批"),text:this.$t("系统角色审批"),value:2},{label:this.$t("发起人自选审批"),text:this.$t("发起人自选审批"),value:3},{label:this.$t("抄送给固定人"),text:this.$t("抄送给固定人"),value:4},{label:this.$t("抄送给系统角色"),text:this.$t("抄送给系统角色"),value:5},{label:this.$t("自选抄送人"),text:this.$t("自选抄送人"),value:6}]}},created:function(){},methods:{initAsync:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var data,l,o,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.roleGroup={},e.next=3,t.getRoleTreeInfo(5);case 3:for(data=t.dataRoleTreeList,l=[],o={},i=0;i<data.length;i++)if(data[i].children)for(n=0;n<data[i].children.length;n++)l.push({id:data[i].children[n].id,name:data[i].children[n].label}),o[data[i].children[n].id]=data[i].children[n].label;t.roleGroup=o;case 8:case"end":return e.stop()}}),e)})))()},selAuditType:function(t,e,l){var o={type:t,extra:e,name:this.auditFlowTypeItemInfo(t,"set"),users:[],hType:"",hrole:[],hName:"",andor:"or",waitName:!1,allowShow:!1,allowMuti:!1,rejectShow:!1,rejectMuti:!1,transferShow:!1,transferMuti:!1,allShow:!1,allEdit:!1,applicantShow:!1,applicantEdit:!1,right1:[],right2:[]};this.flowData.splice(l,0,o),this.selFlowItemBlock(null,o,l)},delAuditType:function(t,data,e){this.flowData.splice(e,1)},handleClick:function(t){this.activeName=t},handleAuditTypeChange:function(data){this.form.auditType=data},handleUserType:function(data){this.flowDetailData.htype=data,this.flowDetailData.hType=data},auditFlowTypeItemInfo:function(t,e){return Object(r.q)(t,e)},selFlowItemBlock:function(t,data,e){this.flowDetailData=data,this.approverUsers=data.users,this.flowDetailIndex=e;if(this.formId.form_content){var l=JSON.parse(this.formId.form_content);this.formFieldList=this.setRuleChild(l.rule,[]),this.formFieldList.length==this.flowDetailData.right1.length?this.checkRight1All=!0:this.checkRight1All=!1,this.formFieldList.length==this.flowDetailData.right2.length?this.checkRight2All=!0:this.checkRight2All=!1}},setRuleChild:function(t,e){for(var l={},i=0;i<t.length;i++)t[i].children&&t[i].children.length>0?this.setRuleChild(t[i].children,e):t[i].field&&(l={field:t[i].field,title:t[i].title,type:t[i].type,value:t[i].value},e.push(l));return e},loadingShow:function(t){var e=this,l=null;switch(clearTimeout(l),t){case 1:this.refreshTeacherStatus=!0,l=setTimeout((function(){e.refreshTeacherStatus=!1,clearTimeout(l)}),1e3)}},handleShowTeacher:function(t){var e=this;setTimeout((function(){1==t&&e.$refs.popverTeacherRef._handleOpen()}),800)},handleSelUser:function(data,t){if(1==t){this.flowDetailData.users=data,this.flowDetailData.hName=[];for(var i=0;i<data.length;i++)this.flowDetailData.hName.push(data[i].real_name)}this.approverUsers=this.flowDetailData.users},versionList:function(){this.$emit("versionClick")},handleCheckedRight1Change:function(data){this.flowDetailData.right1=data,this.formFieldList.length==this.flowDetailData.right1.length?this.checkRight1All=!0:this.checkRight1All=!1},handleCheckedRight2Change:function(data){this.flowDetailData.right2=data,this.formFieldList.length==this.flowDetailData.right2.length?this.checkRight2All=!0:this.checkRight2All=!1},handleCheckAllChangeRight1:function(data){if(1==data){if(this.formId.form_content){for(var t=[],i=0;i<this.formFieldList.length;i++)t.push(this.formFieldList[i].field);this.flowDetailData.right1=t}}else this.flowDetailData.right1=[]},handleCheckAllChangeRight2:function(data){if(1==data){if(this.formId.form_content){for(var t=[],i=0;i<this.formFieldList.length;i++)t.push(this.formFieldList[i].field);this.flowDetailData.right2=t}}else this.flowDetailData.right2=[]},handleCascaderChange:function(data){this.flowDetailData.hrole=data},showPop:function(){this.flowCustonUserStatus=!1;for(var i=0;i<this.flowData.length;i++)if("CustomUser"==this.flowData[i].hType){this.flowCustonUserStatus=!0;break}}}},f=(l(1695),l(10)),component=Object(f.a)(d,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("div",{staticClass:"form-set-main",style:t.drawHeight3},[l("div",{staticClass:"pull-right form-set-right",staticStyle:{"overflow-y":"auto"}},[l("div",{staticClass:"header-block padding-lr-10 border-bottom-1"},[l("el-row",[l("el-col",{staticClass:"text-center",attrs:{span:12}},[l("span",{staticClass:"tab-class font-bold",class:"only"==t.activeName?"color-warning":"",on:{click:function(e){return t.handleClick("only")}}},[l("i",{staticClass:"fa fa-file"}),t._v("\n                "+t._s(t.$t("节点属性"))+"\n              ")])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:12}},[l("span",{staticClass:"tab-class font-bold margin-left-5",class:"flow"==t.activeName?"color-warning":"",on:{click:function(e){return t.handleClick("flow")}}},[l("i",{staticClass:"fa fa-line-chart"}),t._v("\n                "+t._s(t.$t("流程属性"))+"\n              ")])])],1)],1),t._v(" "),l("div",{staticClass:"margin-top-10 padding-lr-10 font-size-12"},["only"==t.activeName?[l("div",[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("节点类型")))]),t._v(" "),"audit"==t.flowDetailData.extra?l("div",{staticClass:"margin-top-10"},[t._v(t._s(t.$t("审批节点")))]):t._e(),t._v(" "),"send"==t.flowDetailData.extra?l("div",{staticClass:"margin-top-10"},[t._v(t._s(t.$t("抄送节点")))]):t._e()]),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("节点名称")))]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:t.flowDetailData.name,callback:function(e){t.$set(t.flowDetailData,"name",e)},expression:"flowDetailData.name"}})],1)]),t._v(" "),l("div",{staticClass:"margin-top-10"},["send"==t.flowDetailData.extra?[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("抄送人")))]),t._v(" "),l("div",{staticClass:"margin-top-5"},[4==t.flowDetailData.type||6==t.flowDetailData.type?l("el-popover",{attrs:{"popper-class":"custom-popper-class-form",placement:"left",width:"700",trigger:"click"},on:{show:function(e){return t.handleShowTeacher(1)}}},[l("div",[l("teacher-tree-and-list-no-page",{ref:"popverTeacherRef",attrs:{"user-type":"user","sel-arr":t.flowDetailData.users,"set-type":"check"},on:{select:function(e){return t.handleSelUser(e,1)}}})],1),t._v(" "),l("el-button",{attrs:{slot:"reference",type:"success",plain:"",size:"small"},on:{click:function(e){return t.loadingShow(1)}},slot:"reference"},[1==t.refreshTeacherStatus?l("i",{staticClass:"fa fa-refresh fa-spin"}):t._e(),t._v("\n                      "+t._s(t.$t("抄送人"))+"("+t._s(t.$t("人数"))+":"+t._s(t.approverUsers.length)+")\n                    ")])],1):t._e(),t._v(" "),5==t.flowDetailData.type?l("my-select",{attrs:{size:"mini","sel-value":t.flowDetailData.hType,options:t.fiterTeacherRoleType},on:{change:t.handleUserType}}):t._e()],1)]:t._e(),t._v(" "),"audit"==t.flowDetailData.extra?[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("审批人")))]),t._v(" "),l("div",{staticClass:"margin-top-5"},[1==t.flowDetailData.type||3==t.flowDetailData.type?l("el-popover",{attrs:{"popper-class":"custom-popper-class-form",placement:"left",width:"700",trigger:"click"},on:{show:function(e){return t.handleShowTeacher(1)}}},[l("div",[l("teacher-tree-and-list-no-page",{ref:"popverTeacherRef",attrs:{"user-type":"user","sel-arr":t.flowDetailData.users,"set-type":"check"},on:{select:function(e){return t.handleSelUser(e,1)}}})],1),t._v(" "),l("el-button",{attrs:{slot:"reference",type:"success",plain:"",size:"small"},on:{click:function(e){return t.loadingShow(1)}},slot:"reference"},[1==t.refreshTeacherStatus?l("i",{staticClass:"fa fa-refresh fa-spin"}):t._e(),t._v("\n                      "+t._s(t.$t("审批人"))+"("+t._s(t.$t("人数"))+":"+t._s(t.approverUsers.length)+")\n                    ")])],1):t._e(),t._v(" "),2==t.flowDetailData.type?l("my-select",{attrs:{size:"mini",clearable:!0,"sel-value":t.flowDetailData.hType,options:t.fiterTeacherRoleType},on:{change:t.handleUserType}}):t._e()],1)]:t._e(),t._v(" "),[l("div",{staticClass:"font-bold margin-top-10"},[t._v(t._s(t.$t("审批人(部门角色)")))]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("my-cascader",{ref:"SelectorDept",attrs:{size:"mini",clearable:!0,props:{multiple:!0},"sel-value":t.flowDetailData.hrole,type:"5","sub-type":""},on:{change:function(e){return t.handleCascaderChange(e)}}})],1)]],2),t._v(" "),"send"!=t.flowDetailData.extra?[l("div",{staticClass:"margin-top-10 border-bottom-1 padding-bottom-5"},[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("多人审批规则")))]),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("span",[t._v(t._s(t.$t("会签")))]),t._v(" "),l("span",{staticClass:"color-muted"},[t._v("("+t._s(t.$t("所有审批人同意"))+")")])]),t._v(" "),l("el-col",{staticClass:"text-right",attrs:{span:4}},[l("el-radio",{attrs:{label:"and"},model:{value:t.flowDetailData.andor,callback:function(e){t.$set(t.flowDetailData,"andor",e)},expression:"flowDetailData.andor"}},[t._v(" ")])],1)],1)],1),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("span",[t._v(t._s(t.$t("或签")))]),t._v(" "),l("span",{staticClass:"color-muted"},[t._v("("+t._s(t.$t("其中一人审批同意"))+")")])]),t._v(" "),l("el-col",{staticClass:"text-right",attrs:{span:4}},[l("el-radio",{attrs:{label:"or"},model:{value:t.flowDetailData.andor,callback:function(e){t.$set(t.flowDetailData,"andor",e)},expression:"flowDetailData.andor"}},[t._v(" ")])],1)],1)],1)]),t._v(" "),l("div",{staticClass:"margin-top-10 border-bottom-1 padding-bottom-5"},[l("div",{staticClass:"font-bold"},[t._v(t._s(t.$t("按钮权限")))]),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:16}},[t._v("\n                       \n                    ")]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:8}},[l("el-row",[l("el-col",{staticClass:"text-center",attrs:{span:12}},[t._v("\n                           \n                        ")]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:12}},[l("span",[t._v(t._s(t.$t("显示")))])])],1)],1)],1),t._v(" "),l("el-row",{staticClass:"margin-top-5"},[l("el-col",{attrs:{span:16}},[l("span",[t._v(t._s(t.$t("同意")))])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:8}},[l("el-row",[l("el-col",{staticClass:"text-center",attrs:{span:12}},[t._v("\n                           \n                        ")]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:12}},[l("el-checkbox",{model:{value:t.flowDetailData.allowShow,callback:function(e){t.$set(t.flowDetailData,"allowShow",e)},expression:"flowDetailData.allowShow"}})],1)],1)],1)],1),t._v(" "),l("el-row",{staticClass:"margin-top-5"},[l("el-col",{attrs:{span:16}},[l("span",[t._v(t._s(t.$t("驳回")))])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:8}},[l("el-row",[l("el-col",{staticClass:"text-center",attrs:{span:12}},[t._v("\n                           \n                        ")]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:12}},[l("el-checkbox",{model:{value:t.flowDetailData.rejectShow,callback:function(e){t.$set(t.flowDetailData,"rejectShow",e)},expression:"flowDetailData.rejectShow"}})],1)],1)],1)],1)],1)])]:t._e()]:t._e(),t._v(" "),"flow"==t.activeName?[l("div",{staticClass:"margin-top-10"},[l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("span",[t._v(t._s(t.$t("流程发起后允许撤回")))])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:4}},[l("el-checkbox",{model:{value:t.form.allowBack,callback:function(e){t.$set(t.form,"allowBack",e)},expression:"form.allowBack"}})],1)],1)],1),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("span",[t._v(t._s(t.$t("审批人为发起人时自动审批")))])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:4}},[l("el-checkbox",{model:{value:t.form.autoAudit,callback:function(e){t.$set(t.form,"autoAudit",e)},expression:"form.autoAudit"}})],1)],1)],1),t._v(" "),l("div",{staticClass:"margin-top-10"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("span",[t._v(t._s(t.$t("相邻节点审批人合并审批")))])]),t._v(" "),l("el-col",{staticClass:"text-center",attrs:{span:4}},[l("el-checkbox",{model:{value:t.form.merge,callback:function(e){t.$set(t.form,"merge",e)},expression:"form.merge"}})],1)],1)],1)])]:t._e()],2)]),t._v(" "),l("div",{staticClass:"form-set-left"},[l("div",{staticClass:"text-center flow-main-block",staticStyle:{"overflow-y":"auto",position:"relative"},style:t.drawHeight5},[l("div",{staticClass:"flow-fixed-block font-size-12 font-bold margin-bottom-20 bg-success"},[l("span",[t._v(t._s(t.$t("开始")))])]),t._v(" "),l("div",{staticClass:"margin-bottom-20 margin-top-20"},[l("my-form-audit-type",{attrs:{"item-index":"0","custom-user-status":t.flowCustonUserStatus},on:{click:t.selAuditType,showPop:t.showPop}})],1),t._v(" "),t._l(t.flowData,(function(e,o){return t.flowData.length>0?l("div",{key:o},[l("div",{staticClass:"flow-item-block",on:{click:function(l){return t.selFlowItemBlock(l,e,o)}}},[l("div",{staticClass:"flow-item-title-block",class:"audit"==e.extra?"bg-warning":"bg-success"},[l("i",{staticClass:"fa fa-times-circle flow-item-close-block color-danger",on:{click:function(l){return l.stopPropagation(),t.delAuditType(l,e,o)}}}),t._v(" "),l("span",{staticClass:"font-bold font-size-12"},[l("el-row",[l("el-col",{attrs:{span:20}},[l("i",{staticClass:"fa fa-tag"}),t._v(" "),l("label",[t._v(t._s(e.name))])]),t._v(" "),l("el-col",{staticClass:"text-right",attrs:{span:4}},[l("i",{staticClass:"fa fa-cog"})])],1)],1)]),t._v(" "),l("div",{staticClass:"padding-lr-10 padding-tb-10 text-left font-size-12"},[l("div",[l("div",[l("span",{staticStyle:{position:"relative",top:"-5px"}},[l("i",{staticClass:"fa fa-users"}),t._v(" "),l("label",[t._v(t._s(t.$t("审批人"))+": ")])]),t._v(" "),l("span",[1==e.type||3==e.type||4==e.type||6==e.type?[e.hName.length>0?l("span",[t._l(e.hName,(function(e,o){return o<4?l("el-tag",{key:o,staticClass:"margin-left-5 moon-content-text-ellipsis-class",staticStyle:{width:"50px"},attrs:{size:"mini"}},[l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e,placement:"top-start"}},[l("span",[t._v(t._s(e))])])],1):t._e()})),t._v(" "),e.users.length>=4?l("label",{staticClass:"flow-user-count-tag margin-left-5"},[t._v("4+")]):t._e()],2):l("span",{staticClass:"color-muted",staticStyle:{position:"relative",top:"-5px"}},[t._v("\n                          无\n                        ")])]:t._e(),t._v(" "),2==e.type||5==e.type?[""!=e.hType?l("el-tag",{staticClass:"margin-left-5 moon-content-text-ellipsis-class",staticStyle:{width:"50px"},attrs:{size:"mini"}},["MasterTeacher"==e.hType?l("label",[t._v(t._s(t.$t("班主任")))]):t._e(),t._v(" "),"CoachTeacher"==e.hType?l("label",[t._v(t._s(t.$t("辅导员")))]):t._e(),t._v(" "),"DirectorTeacher"==e.hType?l("label",[t._v(t._s(t.$t("系主任")))]):t._e(),t._v(" "),"DormitorTeacher"==e.hType?l("label",[t._v(t._s(t.$t("宿管员")))]):t._e(),t._v(" "),"DeputyDirectorTeacher"==e.hType?l("label",[t._v(t._s(t.$t("系副主任")))]):t._e(),t._v(" "),"StudentManageTeacher"==e.hType?l("label",[t._v(t._s(t.$t("学管主任")))]):t._e(),t._v(" "),"SecretaryTeacher"==e.hType?l("label",[t._v(t._s(t.$t("系部主任")))]):t._e()]):l("span",{staticClass:"color-muted",staticStyle:{position:"relative",top:"-5px"}},[t._v("无")])]:t._e()],2)]),t._v(" "),e.hrole&&e.hrole.length>0?l("div",[l("span",{staticStyle:{position:"relative",top:"-5px"}},[l("i",{staticClass:"fa fa-users"}),t._v(" "),l("label",[t._v(t._s(t.$t("部门角色"))+": ")])]),t._v(" "),l("span",[[t._l(e.hrole,(function(e,o){return o<4?l("el-tag",{key:o,staticClass:"margin-left-5 moon-content-text-ellipsis-class",staticStyle:{width:"50px"},attrs:{size:"mini"}},[l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.roleGroup[e[1]],placement:"top-start"}},[l("span",[t._v(t._s(t.roleGroup[e[1]]))])])],1):t._e()})),t._v(" "),e.hrole.length>=4?l("label",{staticClass:"flow-user-count-tag margin-left-5"},[t._v("4+")]):t._e()]],2)]):t._e(),t._v(" "),"send"!=e.extra?l("div",{staticClass:"margin-top-5"},[l("span",{staticStyle:{position:"relative",top:"-5px"}},[l("i",{staticClass:"fa fa-cog"}),t._v(" "),l("label",[t._v(t._s(t.$t("权限"))+": ")])]),t._v(" "),l("span",[e.allowShow||e.allowMuti?l("el-tag",{staticClass:"margin-left-5 moon-content-text-ellipsis-class",staticStyle:{width:"50px"},attrs:{size:"mini",type:"success"}},[t._v("\n                        "+t._s(t.$t("提交"))+"\n                      ")]):t._e(),t._v(" "),e.rejectShow||e.rejectMuti?l("el-tag",{staticClass:"margin-left-5 moon-content-text-ellipsis-class",staticStyle:{width:"50px"},attrs:{size:"mini",type:"success"}},[t._v("\n                        "+t._s(t.$t("驳回"))+"\n                      ")]):t._e()],1)]):t._e()])])]),t._v(" "),l("div",{staticClass:"margin-bottom-20 margin-top-20"},[l("my-form-audit-type",{attrs:{"item-index":o+1,"pop-visible":t.popVisible},on:{click:t.selAuditType}})],1)]):t._e()})),t._v(" "),l("div",{staticClass:"flow-fixed-block font-size-12 font-bold bg-danger"},[l("span",[t._v(t._s(t.$t("结束")))])])],2)]),t._v(" "),l("div",{staticClass:"moon-clearfix"})])])}),[],!1,null,"402c0f10",null);e.default=component.exports;installComponents(component,{TeacherTreeAndListNoPage:l(1305).default,MySelect:l(1256).default,MyCascader:l(1265).default,MyFormAuditType:l(1316).default})},1695:function(t,e,l){"use strict";var o=l(1394);l.n(o).a},1696:function(t,e,l){(e=l(30)(!1)).push([t.i,".form-set-main[data-v-402c0f10]{box-shadow:0 0 4px #dcdfe6;border-right:1px solid #dcdfe6}.form-set-left[data-v-402c0f10]{margin-right:310px}.form-set-left[data-v-402c0f10],.form-set-right[data-v-402c0f10]{background:#f8f8f8;height:100%;box-shadow:0 0 4px #dcdfe6}.form-set-right[data-v-402c0f10]{width:300px}.form-set-menu-item[data-v-402c0f10]{font-size:12px;text-align:center;height:40px;line-height:40px}.form-set-menu-item-active[data-v-402c0f10]{background:#3e8db8;color:#fff}.title-block-tag[data-v-402c0f10]{display:inline-block;height:20px;width:3px;background:#e6a23c;font-weight:700;border-radius:3px}.title-block-text[data-v-402c0f10]{font-weight:700;position:relative;top:-5px}.item-tag-block[data-v-402c0f10]{height:25px;line-height:25px;background:#8cc5ff;border-radius:5px;padding:0 10px;color:#909399}.flow-fixed-block[data-v-402c0f10]{width:40px;height:40px;line-height:40px;border-radius:100%;margin:20px auto 0;color:#fff}.flow-item-block[data-v-402c0f10]{border-radius:5px;background:#fff;min-height:50px;width:350px;margin:20px auto;box-shadow:0 0 4px #dcdfe6}.flow-item-title-block[data-v-402c0f10]{position:relative;height:30px;line-height:30px;padding:0 10px;color:#fff;text-align:left;border-top-left-radius:5px;border-top-right-radius:5px}.flow-item-close-block[data-v-402c0f10]{position:absolute;right:-10px;top:-10px}.flow-user-count-tag[data-v-402c0f10]{position:relative;display:inline-block;width:20px;height:20px;line-height:20px;border-radius:100%;background:#f56c6c;text-align:center;font-size:12px;color:#fff;top:-5px}.header-block[data-v-402c0f10]{height:40px;line-height:40px}.tab-class[data-v-402c0f10]{cursor:default;padding:10px}",""]),t.exports=e},1697:function(t,e,l){"use strict";var o=l(1395);l.n(o).a},1698:function(t,e,l){(e=l(30)(!1)).push([t.i,".container[data-v-75665b9d]{padding:10px 15px}.header-block[data-v-75665b9d]{height:40px;line-height:40px}.tab-class[data-v-75665b9d]{cursor:default;padding:10px}",""]),t.exports=e},1976:function(t,e,l){"use strict";l.r(e);l(65),l(107);var o=l(76),n=l(7),r=l(6),c=l(86),d=l.n(c),f={data:function(){return{rules:{name:[{required:!0,message:this.$t("请输入名称"),trigger:"blur"},{validator:d.a.FormValidate.Form().validatenallOther1_20Reg,trigger:"blur"}]}}}},h={components:{MyProcessFlow:l(1545).default},mixins:[o.a,f],data:function(){return{subTitle:"",tableData:[],visibleConfim:!1,dialogLoading:!1,dialogVisible:!1,drawerForm:!1,btnLoading:!1,searchKey:"",flowListData:[],formFieldList:[],flowFormData:{},serverDataItem:"",form:{id:"",name:"",desc:""},formOption:{form:{inline:!1,labelPosition:"right",size:"mini",labelWidth:"125px",hideRequiredAsterisk:!1,showMessage:!0,inlineMessage:!1}}}},created:function(){this.init()},methods:{init:function(){var t=this,e={page:this.page,num:this.num,searchKey:this.searchKey};this.$axios.get(n.a.server_form_template_form_process_page,{params:e}).then((function(e){e.data.data&&(t.tableData=e.data.data.list,t.total=e.data.data.totalCount,t.num=e.data.data.num,t.page=e.data.data.currentPage)}))},initProcess:function(t){var e=t.form_process?JSON.parse(t.form_process):[],l="";this.flowListData=[];for(var o=0;o<e.length;o++){var n=[];"handle"==e[o].ntype?l="audit":"cc"==e[o].ntype&&(l="send");for(var r={type:e[o].nChildType,extra:l,name:e[o].nname,hType:e[o].htype,hrole:e[o].hrole,hName:e[o].hname,andor:e[o].andor,waitName:e[o].sign,allowShow:e[o].agreed1,allowMuti:e[o].agreed2,rejectShow:e[o].notagreed1,rejectMuti:e[o].notagreed2,transferShow:e[o].trans1,transferMuti:e[o].trans2,right1:e[o].right1?e[o].right1:[],right2:e[o].right2?e[o].right2:[]},c=0;c<e[o].hid.length;c++)n.push({user_id:e[o].hid[c],real_name:e[o].hname[c]});r.users=n,this.flowListData.push(r)}var d={id:t.id,auditType:"",name:t.version_name,allowBack:!!t.allow_revoke&&t.allow_revoke,urge:!!t.allow_urge&&t.allow_urge,autoAudit:!!t.allow_auto&&t.allow_auto,merge:!!t.allow_merge&&t.allow_merge};this.flowFormData=d},addInfo:function(){this.dialogVisible=!0},editInfo:function(t){this.form={id:t.id,name:t.process_name,desc:t.des},this.dialogVisible=!0},deleteInfo:function(t){this.form.id=t.id,this.visibleConfim=!0},settingInfo:function(t,e){this.serverDataItem=t,this.serverDataIndex=e,this.initProcess(t),this.drawerForm=!0},search:function(data){this.searchKey=data.input,this.page=1,this.init()},sizeChange:function(t){this.page=1,this.num=t,this.init()},currentPage:function(t){this.page=t,this.init()},jumpPage:function(data){this.page=data,this.init()},openedForm:function(){var t=this;this.formLoading=!0,setTimeout((function(){if(t.serverDataItem.form_content){var e=JSON.parse(t.serverDataItem.form_content);t.$refs.designer.setRule(e.rule),t.$refs.designer.setOption(e.option)}else t.$refs.designer.setRule([]),t.$refs.designer.setOption(t.formOption);t.$refs.designer.removeMenuItem("span"),t.formLoading=!1}),800)},openForm:function(){this.$refs.flow&&this.$refs.flow.initAsync()},closeDialog:function(t){this.form={id:"",name:"",desc:""},this.flowListData=[],this.flowFormData={auditType:"",name:"",allowBack:!1,urge:!1,autoAudit:!1,merge:!1},this.subTitle="",this.versionStatus="",this.serverDataItem={},this.serverDataIndex="",this.$refs.flow&&(this.$refs.flow.flowDetailData={},this.$refs.flow.approverUsers=[],this.$refs.flow.formFieldList=[]),this.$refs.form&&this.$refs.form.resetFields(),this.btnLoading=!1,this.drawerForm=!1},cancelDialog:function(){this.dialogVisible=!1},okDialog:function(){var t=this,e="";this.$refs.form.validate((function(l){if(l){var o={processName:t.form.name,des:t.form.desc};""!=t.form.id&&(o.id=t.form.id),e=n.a.server_form_template_form_process_save,o=t.$qs.stringify(o),t.dialogLoading=!0,t.$axios.post(e,o).then((function(e){200==e.data.code?(t.dialogVisible=!1,t.init(),Object(r.b)(e.data.desc)):Object(r.a)(e.data.desc),t.dialogLoading=!1}))}}))},handleCancelChange:function(data){this.visibleConfim=!1},handleOkChange:function(data){var t,e=this,l={id:this.form.id};t=n.a.server_form_template_form_process_del,l=this.$qs.stringify(l),this.dialogLoading=!0,this.$axios.post(t,l).then((function(t){200==t.data.code?(e.init(),Object(r.b)(t.data.desc)):Object(r.a)(t.data.desc),e.visibleConfim=!1,e.dialogLoading=!1}))},cancelDrawDialog:function(){this.detailData="",this.drawerVisible=!1,this.drawerForm=!1},okFormDrawDialog:function(t){var e=this,l=this.$refs.flow.flowData,o=this.$refs.flow.form,c="",d="",f=[],h=[],m=[],v={};if(0!=l.length)if(""!=o.name){for(var i=0;i<l.length;i++){if(f=[],h=[],"audit"==l[i].extra?c="handle":"send"==l[i].extra&&(c="cc"),1==l[i].type||4==l[i].type){d="AnyUser";for(var _=l[i].users,w=0;w<_.length;w++)f.push(_[w].user_id),h.push(_[w].real_name)}else if(2==l[i].type||5==l[i].type)d=l[i].hType;else if(3==l[i].type||6==l[i].type){d="CustomUser";for(var y=l[i].users,C=0;C<y.length;C++)f.push(y[C].user_id),h.push(y[C].real_name)}var x={ntype:c,nChildType:l[i].type,nname:l[i].name,horder:i+1,htype:d,hrole:l[i].hrole,hid:f,hname:h,andor:l[i].andor,sign:l[i].waitName,agreed1:l[i].allowShow,agreed2:l[i].allowMuti,notagreed1:l[i].rejectShow,notagreed2:l[i].rejectMuti,trans1:l[i].transferShow,trans2:l[i].transferMuti,right1:l[i].right1,right2:l[i].right2};m.push(x)}v={versionName:o.name,id:this.serverDataItem.id,formProcess:JSON.stringify(m),allowRevoke:o.allowBack,allowUrge:o.urge,allowAuto:o.autoAudit,allowMerge:o.merge},""!=o.id&&"new"!=t&&(v.id=o.id),v=this.$qs.stringify(v),this.btnLoading=!0,this.$axios.post(n.a.server_form_template_form_process_set,v,{loading:!1}).then((function(t){200==t.data.code?(e.drawerForm=!1,e.init(),Object(r.b)(t.data.desc)):Object(r.a)(t.data.desc),e.btnLoading=!1}))}else Object(r.c)(this.$t("流程属性中未设置流程名称！"));else Object(r.c)(this.$t("请设置流程信息！"))}}},m=(l(1697),l(10)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"container"},[l("layout-tb",[l("template",{slot:"tag"},[t._v("流程管理")]),t._v(" "),l("div",{attrs:{slot:"tab"},slot:"tab"},[l("el-row",[l("el-col",{attrs:{span:6}},[l("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.addInfo(e)}}},[t._v(t._s(t.$t("添加流程")))])],1),t._v(" "),l("el-col",{staticClass:"text-right",attrs:{span:18}},[l("my-input-button",{ref:"teacher width-150",attrs:{size:"small",plain:"","width-class":"width: 180px",type:"success",clearable:!0,placeholder:t.$t("名称")},on:{click:t.search}})],1)],1)],1),t._v(" "),l("div",{attrs:{slot:"content"},slot:"content"},[l("el-table",{ref:"refTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-class-name":"custom-table-cell-bg",size:"medium","row-key":"id","max-height":t.tableHeight.height}},[l("el-table-column",{attrs:{align:"center",label:t.$t("编号")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s(e.row.id))])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:t.$t("名称")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[t._v(t._s(e.row.process_name))]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[l("span",[t._v(t._s(e.row.process_name))])])])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:t.$t("创建时间")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s(t.$moment(e.row.create_time).format("YYYY-MM-DD HH:mm")))])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:t.$t("描述")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[t._v(t._s(e.row.des?e.row.des:"--"))]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[l("span",[t._v(t._s(e.row.des?e.row.des:"--"))])])])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:t.$t("被引用表单")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[t._v(t._s(e.row.form_name?e.row.form_name:"--"))]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[l("span",[t._v(t._s(e.row.form_name?e.row.form_name:"--"))])])])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("i",{staticClass:"fa fa-cog color-success margin-right-5",on:{click:function(l){return t.settingInfo(e.row,e.$index)}}}),t._v(" "),l("i",{staticClass:"fa fa-edit color-grand margin-right-5",on:{click:function(l){return t.editInfo(e.row)}}}),t._v(" "),l("i",{staticClass:"fa fa-trash color-danger",on:{click:function(l){return t.deleteInfo(e.row)}}})]}}])})],1),t._v(" "),l("div",{staticClass:"layout-right-footer text-right"},[l("my-pagination",{staticClass:"layout-pagination",attrs:{total:t.total,"current-page":t.page,"page-size":t.num},on:{currentPage:t.currentPage,sizeChange:t.sizeChange,jumpChange:t.jumpPage}})],1)],1)],2),t._v(" "),l("dialog-normal",{attrs:{top:"10vh",visible:t.dialogVisible,title:t.$t("流程设置")},on:{close:t.closeDialog,"right-close":t.cancelDialog}},[l("div",{staticClass:"margin-top-10"},[l("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"140px"}},[l("el-form-item",{attrs:{label:t.$t("流程名称"),prop:"name"}},[l("el-input",{staticClass:"width-260",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),l("el-form-item",{attrs:{label:t.$t("描述")}},[l("el-input",{staticClass:"width-260",model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1)],1)],1),t._v(" "),l("div",{attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"small"},on:{click:t.cancelDialog}},[t._v(t._s(t.$t("取消")))]),t._v(" "),l("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){0==t.dialogLoading&&t.okDialog()}}},[t.dialogLoading?l("i",{staticClass:"el-icon-loading"}):t._e(),t._v("\n        "+t._s(t.$t("确定"))+"\n      ")])],1)]),t._v(" "),l("drawer-layout-right",{attrs:{tabindex:"0",title:t.$t("流程设计"),"show-close":!0,visible:t.drawerForm,size:"85%"},on:{opened:t.openForm,changeDrawer:t.closeDialog}},[l("div",{attrs:{slot:"title"},slot:"title"},[l("div",{staticClass:"header-block padding-lr-10"},[l("span",{staticClass:"tab-class font-bold"},[l("i",{staticClass:"fa fa-line-chart"}),t._v("\n          "+t._s(t.$t("流程设计"))+"\n        ")])])]),t._v(" "),l("div",{attrs:{slot:"content"},slot:"content"},[l("div",{staticStyle:{position:"relative"}},[l("my-process-flow",{ref:"flow",attrs:{formId:t.serverDataItem,"flow-data":t.flowListData,form:t.flowFormData}})],1)]),t._v(" "),l("div",{attrs:{slot:"footer"},slot:"footer"},[l("div",{staticClass:"text-right padding-lr-10"},[l("el-button",{attrs:{size:"mini"},on:{click:t.cancelDrawDialog}},[t._v(t._s(t.$t("取消")))]),t._v(" "),l("el-button",{attrs:{size:"mini",type:"success",loading:t.btnLoading},on:{click:function(e){return t.okFormDrawDialog()}}},[t._v(t._s(t.$t("保存")))])],1)])]),t._v(" "),l("my-normal-dialog",{attrs:{visible:t.visibleConfim,loading:t.dialogLoading,title:"提示",detail:t.subTitle,content:"确认需要删除该信息？"},on:{"update:visible":function(e){t.visibleConfim=e},"ok-click":t.handleOkChange,"cancel-click":t.handleCancelChange,close:t.closeDialog}})],1)}),[],!1,null,"75665b9d",null);e.default=component.exports;installComponents(component,{MyInputButton:l(1257).default,MyPagination:l(234).default,LayoutTb:l(1261).default,DialogNormal:l(235).default,MyProcessFlow:l(1545).default,DrawerLayoutRight:l(236).default,MyNormalDialog:l(1260).default})}}]);