(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{1256:function(t,e,l){"use strict";l.r(e);l(179);var n=l(6),r={name:"mySelect",props:{placeholder:{default:"",type:String},selValue:{default:"",type:[String,Number,Boolean]},options:{default:function(){return[]},type:Array},size:{defalult:"medium",validate:function(t){return Object(n.D)(t,["large","medium","small","mini"])}},clearable:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean},filterable:{default:!1,type:Boolean},remote:{default:!1,type:Boolean},loading:{default:!1,type:Boolean},group:{default:!1,type:Boolean},remoteMethod:{default:function(data){return data},type:Function},widthStyle:{default:"",type:[String,Number]}},computed:{selectModel:function(){this.value=this.selValue},setPlaceholder:function(){this.selectPlaceholder=this.placeholder?this.placeholder:this.$t("请选择")},setWidth:function(){this.widthStyle&&(this.width={width:this.widthStyle+"px"})}},data:function(){return{selectPlaceholder:"",value:"",width:""}},methods:{handleChange:function(data){this.$emit("change",data)}}},o=l(10),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("el-select",t._b({style:t.width,attrs:{setPlaceholder:t.setPlaceholder,placeholder:t.selectPlaceholder,size:t.size,clearable:t.clearable,disabled:t.disabled,filterable:t.filterable,loading:t.loading,remote:t.remote,"remote-method":t.remoteMethod,setWidth:t.setWidth},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},"el-select",t.selectModel,!1),[0==t.group?t._l(t.options,(function(t,e){return l("el-option",{key:e,attrs:{label:t.label,value:t.value,disabled:t.disabled}})})):t._e(),t._v(" "),1==t.group?t._l(t.options,(function(e){return l("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)})):t._e()],2)],1)}),[],!1,null,null,null);e.default=component.exports},1257:function(t,e,l){"use strict";l.r(e);var n=l(6),r={name:"myInputButton",props:{placeholder:{default:"请输入内容",type:String},widthClass:{default:"width: 150px",type:String},selectWidthClass:{default:"width: 100px",type:String},size:{defalult:"medium",validate:function(t){return Object(n.D)(t,["large","medium","small","mini"])}},type:{defalult:"",validate:function(t){return Object(n.D)(t,["success","info","warning","danger","primary"])}},plain:{default:!1,type:Boolean},iconStyle:{default:"",type:String},showSelect:{default:!1,type:Boolean},clearable:{default:!1,type:Boolean},options:{default:function(){return[]},type:Array}},computed:{},mounted:function(){this.showIcon=""!==this.iconStyle},data:function(){return{inputValue:"",selectValue:"",showIcon:!1}},methods:{handleClick:function(data){var t={};this.selectValue?t={select:this.selectValue,input:this.inputValue}:this.selectValue||(t={input:this.inputValue}),this.$emit("click",t)},selectChange:function(data){this.selectValue=data}}},o=l(10),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("span",[l("el-input",{style:t.widthClass,attrs:{size:t.size,placeholder:t.placeholder,clearable:t.clearable},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}},[t.showSelect?l("el-select",{style:t.selectWidthClass,attrs:{slot:"prepend",clearable:t.clearable,placeholder:t.$t("请选择")},on:{change:t.selectChange},slot:"prepend",model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}},t._l(t.options,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})})),1):t._e()],1),t._v(" "),l("el-button",{attrs:{size:t.size,type:t.type,plain:t.plain},on:{click:t.handleClick}},[t.showIcon?l("i",{class:t.iconStyle}):t._e(),t._v("\n    "+t._s(t.$t("搜索"))+"\n  ")])],1)}),[],!1,null,null,null);e.default=component.exports},1258:function(t,e,l){"use strict";l.r(e);l(179);var n,r=l(104),o=l(6),d={name:"myDatePicker",props:(n={selValue:{default:"",type:[Array,String]},size:{defalult:"medium",validate:function(t){return Object(o.D)(t,["large","medium","small","mini"])}},type:{defalult:"date",validate:function(t){return Object(o.D)(t,["year","month","date","dates","week","datetime","datetimerange","daterange","monthrange"])}},placeholder:{default:"选择日期",type:String}},Object(r.a)(n,"size",{defalult:"medium",validate:function(t){return Object(o.D)(t,["large","medium","small","mini"])}}),Object(r.a)(n,"widthStyle",{default:"",type:[String,Number]}),Object(r.a)(n,"disabled",{default:!1,type:Boolean}),Object(r.a)(n,"readonly",{default:!1,type:Boolean}),Object(r.a)(n,"rangeSeparator",{default:"至",type:String}),Object(r.a)(n,"startPlaceholder",{default:"开始时间",type:String}),Object(r.a)(n,"endPlaceholder",{default:"结束时间",type:String}),Object(r.a)(n,"format",{default:"yyyy-MM-dd",type:String}),Object(r.a)(n,"valueFormat",{default:"yyyy-MM-dd",type:String}),Object(r.a)(n,"unlinkPanels",{default:!0,type:Boolean}),Object(r.a)(n,"clearable",{default:!1,type:Boolean}),Object(r.a)(n,"editable",{default:!1,type:Boolean}),Object(r.a)(n,"pickerOptions",{default:function(){return{}},type:Object}),n),computed:{selectModel:function(){this.value=this.selValue},setWidth:function(){this.widthStyle&&(this.width={width:this.widthStyle+"px"})}},mounted:function(){},data:function(){return{value:"",width:""}},methods:{handleChange:function(data){this.$emit("change",data)}}},c=l(10),component=Object(c.a)(d,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("span",[l("el-date-picker",t._b({style:t.width,attrs:{type:t.type,placeholder:t.placeholder,size:t.size,disabled:t.disabled,readonly:t.readonly,"range-separator":t.rangeSeparator,"start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,"unlink-panels":t.unlinkPanels,format:t.format,"value-format":t.valueFormat,"picker-options":t.pickerOptions,setWidth:t.setWidth,clearable:t.clearable},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},"el-date-picker",t.selectModel,!1))],1)}),[],!1,null,null,null);e.default=component.exports},1261:function(t,e,l){"use strict";l.r(e);var n={name:"LayoutTb",data:function(){return{showTab:!0,showTag:!1}},mounted:function(){this.showTab=void 0!==this.$slots.tab},created:function(){},methods:{}},r=l(10),component=Object(r.a)(n,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("div",{staticClass:"color-muted font-size-12 padding-top-5 animated fadeInUp"},[t.showTag?l("span",{staticClass:"layout-menu-title"},[t._t("tag")],2):t._e()]),t._v(" "),t.showTab?l("div",{staticClass:"layout-top-tab margin-top-5"},[t._t("tab")],2):t._e(),t._v(" "),l("div",{staticClass:"layout-bottom-tab margin-top-10"},[t._t("content")],2)])}),[],!1,null,null,null);e.default=component.exports},1273:function(t,e,l){"use strict";l.r(e);l(179);var n={name:"mySex",props:{type:{default:0,type:[String,Number]}},computed:{selectModel:function(){this.value=this.selValue}},data:function(){return{value:""}},methods:{}},r=l(10),component=Object(r.a)(n,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("span",t._b({},"span",t.selectModel,!1),[[1==t.type?l("label",[t._v(t._s(t.$t("超级管理")))]):t._e(),t._v(" "),2==t.type?l("label",[t._v(t._s(t.$t("学校管理")))]):t._e(),t._v(" "),3==t.type?l("label",[t._v(t._s(t.$t("运维管理")))]):t._e(),t._v(" "),4==t.type?l("label",[t._v(t._s(t.$t("教师")))]):t._e(),t._v(" "),5==t.type?l("label",[t._v(t._s(t.$t("学生")))]):t._e(),t._v(" "),6==t.type?l("label",[t._v(t._s(t.$t("游客")))]):t._e(),t._v(" "),7==t.type?l("label",[t._v(t._s(t.$t("商家")))]):t._e()]],2)}),[],!1,null,null,null);e.default=component.exports},1511:function(t,e,l){var content=l(1922);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,l(31).default)("03e51fef",content,!0,{sourceMap:!1})},1921:function(t,e,l){"use strict";var n=l(1511);l.n(n).a},1922:function(t,e,l){(e=l(30)(!1)).push([t.i,".container[data-v-1c9484c8]{padding:10px 15px}.map-item[data-v-1c9484c8]{border-bottom:1px solid #ddd}.map-item-child[data-v-1c9484c8]{height:45px;line-height:45px}.audit-item[data-v-1c9484c8]{height:30px!important;width:100%!important;border-radius:0!important}",""]),t.exports=e},2121:function(t,e,l){"use strict";l.r(e);l(108),l(65),l(107);var n=l(234),r=l(76),o=l(7),d=l(6),c=l(1261),h=l(1256),m=l(1273),f=l(1258),v=l(1257),_=l(235),y={mixins:[r.a],components:{MyPagination:n.default,LayoutTb:c.default,MySelect:h.default,MyUserType:m.default,MyDatePicker:f.default,MyInputButton:v.default,DialogNormal:_.default},data:function(){return{tableData:[],searchDate:[],typeList:[],searchKey:"",visible:!1,clearTime:"",action:"",modalVisible:!1,map:{},marker:{},addrLineArr:[],alarmInfo:{},addrData:[],rowData:{},refreshStatus:!1}},mounted:function(){},created:function(){this.init(),this.initType()},methods:{init:function(){var t=this,e={page:this.page,num:this.num,timeStart:this.searchDate&&this.searchDate.length>0?this.searchDate[0]+" 00:00:00":"",timeEnd:this.searchDate&&this.searchDate.length>0?this.searchDate[1]+" 23:59:00":""};this.$axios.get(o.a.student_info_warning,{params:e}).then((function(e){e.data.data&&(t.tableData=e.data.data.list,t.total=e.data.data.totalCount,t.num=e.data.data.num,t.page=e.data.data.currentPage)}))},initType:function(){var t=this;this.$axios.get(o.a.log_type).then((function(e){if(e.data.data){for(var l=[],i=0;i<e.data.data.length;i++)if(l.push({label:e.data.data[i].name,id:e.data.data[i].id}),e.data.data[i].list&&e.data.data[i].list.length>0){l[i].options=[];for(var n=0;n<e.data.data[i].list.length;n++)l[i].options.push({label:e.data.data[i].list[n].name,id:e.data.data[i].list[n].id,action:e.data.data[i].list[n].action,value:e.data.data[i].list[n].action})}t.typeList=l}}))},initDetail:function(t){var e=this,l={alarmId:t.id,classId:t.class_id};this.rowData=t,this.$axios.get(o.a.student_info_warning_detail_list,{params:l}).then((function(l){l.data.data?(e.alarmInfo=l.data.data,e.$set(e.alarmInfo,"studentName",t.name),e.$set(e.alarmInfo,"studentPhone",t.phone),e.$set(e.alarmInfo,"className",t.class_name)):(e.$set(e.alarmInfo,"studentName",t.name),e.$set(e.alarmInfo,"studentPhone",t.phone),e.$set(e.alarmInfo,"className",t.class_name))}))},initMap:function(t,e){this.map=new AMap.Map("roadmap",{resizeEnable:!0,zoom:15}),this.initAddrList(t,e)},addMarker:function(t,e){this.marker=new AMap.Marker({position:[t,e],content:'<div class="marker-route marker-marker-bus-from"></div>'}),this.marker.setMap(this.map)},initAddrList:function(t,e){var l=this,n=[],r={page:1,num:999,alarmId:t.id};"local"==e?(this.addrLineArr[this.addrLineArr.length-1],this.addrLineArr[0]||""==this.addrLineArr[0]||this.addrLineArr[1]||""==this.addrLineArr[1]||(this.map.setCenter(this.addrLineArr[this.addrLineArr.length-1]),this.addMarker(this.addrLineArr[this.addrLineArr.length-1][0],this.addrLineArr[this.addrLineArr.length-1][1]))):this.$axios.get(o.a.student_info_warning_detail_map_list,{params:r}).then((function(t){if(t.data.data)if("refresh"==e)l.addrData=t.data.data.locationPage.list;else{l.addrData=t.data.data.locationPage.list;for(var i=0;i<t.data.data.locationPage.list.length;i++)n.push([t.data.data.locationPage.list[i].longitude,t.data.data.locationPage.list[i].latitude]);l.addrLineArr=n,l.addrLineArr[0]||""==l.addrLineArr[0]||l.addrLineArr[1]||""==l.addrLineArr[1]||(l.map.setCenter(l.addrLineArr[l.addrLineArr.length-1]),l.addMarker(l.addrLineArr[l.addrLineArr.length-1][0],l.addrLineArr[l.addrLineArr.length-1][1]))}}))},clearInfo:function(){var t=this;if(""!=this.clearTime){var e={time:this.clearTime?this.clearTime+" 23:59:59":""};e=this.$qs.stringify(e),this.$axios.post(o.a.log_clear,e).then((function(e){200==e.data.code?(t.visible=!1,t.init(),Object(d.b)(e.data.desc)):Object(d.a)(e.data.desc)}))}else Object(d.b)(this.$t("请选择需要清空的日期"))},search:function(data){this.searchKey=data.input,this.page=1,this.init()},sizeChange:function(t){this.page=1,this.num=t,this.init()},currentPage:function(t){this.page=t,this.init()},jumpPage:function(data){this.page=data,this.init()},handleChange:function(data){this.searchDate=data,this.page=1,this.init()},handleClear:function(data){this.clearTime=data},closePopover:function(){this.clearTime=""},handleSelect:function(data){this.action=data,this.init()},cancelDialog:function(){this.modalVisible=!1},closeDialog:function(t){this.modalVisible=!1},showDetail:function(t){var e=this;this.modalVisible=!0,this.initDetail(t),this.$nextTick((function(){e.initMap(t)}))},detailItem:function(t){var e=this;this.$nextTick((function(){e.addrLineArr=[[t.longitude,t.latitude]],e.initMap(t,"local")}))},refreshDetail:function(){var t=this;this.refreshStatus=!0,setTimeout((function(){t.refreshStatus=!1,t.initAddrList(t.rowData,"refresh")}),1500)}}},w=(l(1921),l(10)),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"container"},[l("layout-tb",[l("template",{slot:"tag"},[t._v("学生报警")]),t._v(" "),l("div",{attrs:{slot:"tab"},slot:"tab"},[l("el-row",[l("el-col",{staticClass:"text-right",attrs:{span:24}},[l("div",{staticClass:"layout-inline text-right"},[l("my-date-picker",{staticStyle:{position:"relative",top:"1px"},attrs:{"sel-value":t.searchDate,clearable:!0,type:"daterange",size:"small","width-style":"240"},on:{change:t.handleChange}})],1)])],1)],1),t._v(" "),l("div",{attrs:{slot:"content"},slot:"content"},[l("el-table",{ref:"refTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-class-name":"custom-table-cell-bg",size:"medium","row-key":"id","max-height":t.tableHeight.height}},[l("el-table-column",{attrs:{align:"center",prop:"department_name",label:t.$t("时间")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[t._v(t._s(t.$moment(e.row.created_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[t._v("\n                "+t._s(t.$moment(e.row.created_time).format("YYYY-MM-DD HH:mm:ss"))+"\n              ")])])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",prop:"name",label:t.$t("姓名")}}),t._v(" "),l("el-table-column",{attrs:{align:"center",prop:"student_id",label:t.$t("学号")}}),t._v(" "),l("el-table-column",{attrs:{align:"center",prop:"phone",label:t.$t("联系方式")}}),t._v(" "),l("el-table-column",{attrs:{align:"center",prop:"class_name",label:t.$t("所在班级")}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:t.$t("报警位置")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[t._v(t._s(e.row.address))]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[t._v("\n                "+t._s(e.row.address)+"\n              ")])])]}}])}),t._v(" "),l("el-table-column",{attrs:{align:"center",prop:"class_name",width:"80",label:t.$t("操作")},scopedSlots:t._u([{key:"default",fn:function(e){return[l("i",{staticClass:"fa fa-eye color-grand",on:{click:function(l){return t.showDetail(e.row)}}})]}}])})],1),t._v(" "),l("div",{staticClass:"layout-right-footer text-right"},[l("my-pagination",{staticClass:"layout-pagination",attrs:{total:t.total,"current-page":t.page,"page-size":t.num},on:{currentPage:t.currentPage,sizeChange:t.sizeChange,jumpChange:t.jumpPage}})],1)],1)],2),t._v(" "),l("dialog-normal",{attrs:{"width-style":"1100px",visible:t.modalVisible,"show-footer":!1,title:t.$t("学生报警")},on:{close:t.closeDialog,"right-close":t.cancelDialog}},[l("el-row",[l("el-col",{attrs:{span:6}},[l("div",{staticClass:"margin-right-10"},[l("el-card",{attrs:{"body-style":{padding:"10px"}}},[l("div",{staticClass:"font-size-12 color-muted"},[l("div",[l("span",[t._v(t._s(t.$t("学生"))+": ")]),t._v(" "),l("span",[t._v(t._s(t.alarmInfo?t.alarmInfo.studentName:""))])]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("span",[t._v(t._s(t.$t("联系方式"))+": ")]),t._v(" "),l("span",[t._v(t._s(t.alarmInfo?t.alarmInfo.studentPhone:""))])]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("span",[t._v(t._s(t.$t("班级"))+": ")]),t._v(" "),l("span",[t._v(t._s(t.alarmInfo?t.alarmInfo.className:this.$t("未设置")))])]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("span",[t._v(t._s(t.$t("班主任"))+": ")]),t._v(" "),l("span",[t._v(t._s(t.alarmInfo.realName?t.alarmInfo.realName:this.$t("未设置")))])]),t._v(" "),l("div",{staticClass:"margin-top-5"},[l("span",[t._v(t._s(t.$t("班主任联系方式"))+": ")]),t._v(" "),l("span",[t._v(t._s(t.alarmInfo.realName?t.alarmInfo.phone:this.$t("未设置")))])])])])],1),t._v(" "),l("div",{staticClass:"margin-top-20"},[l("span",{staticClass:"color-warning font-size-12"},[l("i",{staticClass:"fa fa-location-arrow"}),t._v(" "+t._s(t.$t("点击下面地址右侧地图可以进行位置查看"))+"\n          ")])]),t._v(" "),l("el-card",{staticClass:"margin-right-10 margin-top-5",staticStyle:{position:"relative"},attrs:{"body-style":{padding:"10px"}}},[l("label",{staticStyle:{position:"absolute",right:"10px",top:"5px","z-index":"999"}},[l("i",{staticClass:"fa fa-refresh color-warning",class:1==t.refreshStatus?"fa-spin":"",on:{click:t.refreshDetail}})]),t._v(" "),l("div",{staticClass:"font-size-12 color-muted"},t._l(t.addrData,(function(e,n){return l("div",{key:n,staticClass:"map-item",on:{click:function(l){return t.detailItem(e)}}},[l("div",{staticClass:"map-item-child"},[l("el-row",[l("el-col",{attrs:{span:18}},[l("el-popover",{attrs:{trigger:"hover",placement:"right","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[l("div",{staticClass:"moon-content-text-ellipsis-class"},[t._v(t._s(e.address&&""!=e.address?e.address:"--"))])]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[l("div",{staticClass:"moon-content-text-ellipsis-class"},[l("label",[t._v(t._s(e.address&&""!=e.address?e.address:"--"))])])])])],1),t._v(" "),l("el-col",{attrs:{span:6}},[l("el-popover",{attrs:{trigger:"hover",placement:"right","popper-class":"custom-table-popover"}},[l("div",{staticClass:"text-center"},[l("div",{staticClass:"moon-content-text-ellipsis-class"},[t._v(t._s(t.$moment(e.create_time).format("YYYY-MM-DD HH:mm:ss")))])]),t._v(" "),l("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[l("div",{staticClass:"moon-content-text-ellipsis-class"},[l("label",[t._v(t._s(t.$moment(e.create_time).format("YYYY-MM-DD HH:mm:ss")))])])])])],1)],1)],1),t._v(" "),e.voice_url?l("div",{staticClass:"font-size-12 color-disabeld",staticStyle:{position:"relative"}},[l("div",{staticStyle:{background:"rgb(241,243, 244)",height:"30px",width:"40px",position:"absolute",right:"10px",top:"0px","z-index":"999"}}),t._v(" "),l("audio",{staticClass:"audit-item",attrs:{controls:""}},[l("source",{attrs:{src:e.voice_url,type:"audio/mpeg"}}),t._v("\n                  "+t._s(t.$t("浏览器不支持播放器"))+"\n                ")])]):t._e()])})),0)])],1),t._v(" "),l("el-col",{attrs:{span:18}},[l("div",{staticStyle:{height:"450px","overflow-y":"auto"},attrs:{id:"roadmap"}})])],1)],1)],1)}),[],!1,null,"1c9484c8",null);e.default=component.exports;installComponents(component,{MyDatePicker:l(1258).default,MyPagination:l(234).default,LayoutTb:l(1261).default,DialogNormal:l(235).default})}}]);