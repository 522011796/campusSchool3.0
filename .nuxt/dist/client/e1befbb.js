(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1261:function(e,t,r){"use strict";r.r(t);var o={name:"LayoutTb",data:function(){return{showTab:!0,showTag:!1}},mounted:function(){this.showTab=void 0!==this.$slots.tab},created:function(){},methods:{}},n=r(10),component=Object(n.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"color-muted font-size-12 padding-top-5 animated fadeInUp"},[e.showTag?r("span",{staticClass:"layout-menu-title"},[e._t("tag")],2):e._e()]),e._v(" "),e.showTab?r("div",{staticClass:"layout-top-tab margin-top-5"},[e._t("tab")],2):e._e(),e._v(" "),r("div",{staticClass:"layout-bottom-tab margin-top-10"},[e._t("content")],2)])}),[],!1,null,null,null);t.default=component.exports},1263:function(e,t,r){var content=r(1272);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(31).default)("6a31cf35",content,!0,{sourceMap:!1})},1268:function(e,t,r){"use strict";r.r(t);r(65);var o=r(76),n=(r(6),r(7),{mixins:[o.a],props:{title:{default:"信息",type:String},visible:{default:!1,type:Boolean},direction:{default:"rtl",type:String},hideFooter:{default:!1,type:Boolean},loading:{default:!1,type:Boolean},size:{defalult:"30%",type:String},action:{default:"",type:String},downloadFile:{default:"",type:String},accept:{default:"",type:String},data:{default:function(){return{}},type:Object},process:{default:"",type:String},result:{default:function(){return{}||[]},type:[Object,Array]},setBefore:{default:!1,type:Boolean}},computed:{drawer_:{get:function(){return this.visible},set:function(e){this.$emit("changeDrawer",e)}}},data:function(){return{drawer:!1,dialogNormalVisible:!1,footer:!1,header:!1,drawerLoading:!1}},mounted:function(){this.dialogNormalVisible=this.visible,this.footer=void 0!==this.$slots.footer,this.header=void 0!==this.$slots.title},created:function(){},methods:{handleClose:function(data){this.footer?this.handleCancel():this.$emit("right-close",data)},handleOk:function(data){this.$emit("ok",data)},handleCancel:function(data){this.$emit("cancel",data)},download:function(e){window.open(this.downloadFile,"_self")},handleAvatarSuccess:function(e,t){this.$emit("success",e,t)},handleAvatarError:function(e,t){this.$emit("error",e,t)},handleAvatarBefore:function(e){this.setBefore&&(this.data.fileName=e.name)}}}),l=(r(1271),r(10)),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("el-drawer",{staticStyle:{"margin-top":"60px"},attrs:{tabindex:"0","custom-class":"drawer-normal-drawer",visible:e.drawer_,direction:e.direction,wrapperClosable:!0,"show-close":!1,"modal-append-to-body":!1,size:e.size},on:{"update:visible":function(t){e.drawer_=t}}},[r("div",{staticClass:"drawer-normal-title",attrs:{slot:"title"},slot:"title"},[r("span",{attrs:{tabindex:"1"}}),e._v(" "),e.header?e._e():r("el-row",[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"drawer-normal-header"},[r("span",{staticClass:"title"},[e._v(e._s(e.title))])])]),e._v(" "),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"drawer-normal-close text-right color-disabeld font-size-14"},[r("i",{staticClass:"fa fa-close",on:{click:e.handleClose}})])])],1)],1),e._v(" "),r("div",{staticClass:"drawer-normal-body",style:0==e.hideFooter?e.drawHeight:""},[r("div",[r("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.download}},[r("i",{staticClass:"fa fa-download"}),e._v("\n          "+e._s(e.$t("下载模版"))+"\n        ")]),e._v(" "),r("span",{staticClass:"font-size-12 color-muted"},[e._v("("+e._s(e.$t("支持Excel2003或者Excel2007"))+")")])],1),e._v(" "),r("div",{staticClass:"margin-top-10"},[r("div",{staticClass:"padding-tb-5 color-muted"},[r("span",[e._v(e._s(e.$t("文件上传")))])]),e._v(" "),r("div",[r("el-upload",{staticClass:"custom-upload",attrs:{drag:"",action:e.action,accept:e.accept,data:e.data,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError,"before-upload":e.handleAvatarBefore}},[r("i",{staticClass:"el-icon-upload"}),e._v(" "),r("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t("将文件拖到此处，或"))),r("em",[e._v(e._s(e.$t("点击上传")))])])])],1),e._v(" "),r("div",{staticClass:"padding-tb-5 color-muted"},[r("span",[e._v(e._s(e.$t("上传结果")))])]),e._v(" "),r("div",[r("el-timeline",[r("el-timeline-item",[r("div",{staticClass:"color-muted font-size-12"},[r("span",[e._v(e._s(e.$t("上传进度")))])]),e._v(" "),r("div",{staticClass:"color-disabeld font-size-12 margin-top-5"},[""!=e.process?r("span",[e._v(e._s(e.process))]):r("span",[e._v(e._s(e.$t("文件未上传")))])])]),e._v(" "),r("el-timeline-item",[r("div",{staticClass:"color-muted font-size-12"},[r("span",[e._v(e._s(e.$t("上传结果")))])]),e._v(" "),r("div",{staticClass:"color-disabeld font-size-12 margin-top-5"},[Object.keys(e.result).length>0?r("div",e._l(e.result,(function(t,o){return r("div",{key:o},[r("span",[e._v(e._s(t))])])})),0):r("span",[e._v(e._s(e.$t("暂无数据")))])])])],1)],1)])]),e._v(" "),0==e.hideFooter?r("div",{staticClass:"drawer-normal-footer",attrs:{"hide-footer":e.hideFooter}},[r("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v(e._s(e.$t("取消")))]),e._v(" "),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){0==e.loading&&e.handleOk()}}},[e.loading?r("i",{staticClass:"el-icon-loading"}):e._e(),e._v("\n        "+e._s(e.$t("确定"))+"\n      ")])],1):e._e()])],1)}),[],!1,null,"5cbdbb54",null);t.default=component.exports},1271:function(e,t,r){"use strict";var o=r(1263);r.n(o).a},1272:function(e,t,r){(t=r(30)(!1)).push([e.i,"",""]),e.exports=t},1292:function(e,t,r){var o=r(180),n=r(35),l=r(36),c=r(37).f,m=r(241),d=r(1302),h=m("meta"),f=0,v=Object.isExtensible||function(){return!0},_=function(e){c(e,h,{value:{objectID:"O"+ ++f,weakData:{}}})},meta=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!l(e,h)){if(!v(e))return"F";if(!t)return"E";_(e)}return e[h].objectID},getWeakData:function(e,t){if(!l(e,h)){if(!v(e))return!0;if(!t)return!1;_(e)}return e[h].weakData},onFreeze:function(e){return d&&meta.REQUIRED&&v(e)&&!l(e,h)&&_(e),e}};o[h]=!0},1301:function(e,t,r){"use strict";var o=r(15),n=r(21),l=r(181),c=r(49),m=r(1292),d=r(712),h=r(711),f=r(35),v=r(20),_=r(361),C=r(183),y=r(364);e.exports=function(e,t,r){var S=-1!==e.indexOf("Map"),w=-1!==e.indexOf("Weak"),k=S?"set":"add",x=n[e],$=x&&x.prototype,T=x,D={},O=function(e){var t=$[e];c($,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(w&&!f(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return w&&!f(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(w&&!f(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(l(e,"function"!=typeof x||!(w||$.forEach&&!v((function(){(new x).entries().next()})))))T=r.getConstructor(t,e,S,k),m.REQUIRED=!0;else if(l(e,!0)){var z=new T,A=z[k](w?{}:-0,1)!=z,U=v((function(){z.has(1)})),I=_((function(e){new x(e)})),j=!w&&v((function(){for(var e=new x,t=5;t--;)e[k](t,t);return!e.has(-0)}));I||((T=t((function(t,r){h(t,T,e);var o=y(new x,t,T);return null!=r&&d(r,o[k],o,S),o}))).prototype=$,$.constructor=T),(U||j)&&(O("delete"),O("has"),S&&O("get")),(j||A)&&O(k),w&&$.clear&&delete $.clear}return D[e]=T,o({global:!0,forced:T!=x},D),C(T,e),w||r.setStrong(T,e,S),T}},1302:function(e,t,r){var o=r(20);e.exports=!o((function(){return Object.isExtensible(Object.preventExtensions({}))}))},1303:function(e,t,r){"use strict";var o=r(37).f,n=r(182),l=r(713),c=r(184),m=r(711),d=r(712),h=r(362),f=r(363),v=r(32),_=r(1292).fastKey,C=r(111),y=C.set,S=C.getterFor;e.exports={getConstructor:function(e,t,r,h){var f=e((function(e,o){m(e,f,t),y(e,{type:t,index:n(null),first:void 0,last:void 0,size:0}),v||(e.size=0),null!=o&&d(o,e[h],e,r)})),C=S(t),w=function(e,t,r){var o,n,l=C(e),c=k(e,t);return c?c.value=r:(l.last=c={index:n=_(t,!0),key:t,value:r,previous:o=l.last,next:void 0,removed:!1},l.first||(l.first=c),o&&(o.next=c),v?l.size++:e.size++,"F"!==n&&(l.index[n]=c)),e},k=function(e,t){var r,o=C(e),n=_(t);if("F"!==n)return o.index[n];for(r=o.first;r;r=r.next)if(r.key==t)return r};return l(f.prototype,{clear:function(){for(var e=C(this),data=e.index,t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=void 0),delete data[t.index],t=t.next;e.first=e.last=void 0,v?e.size=0:this.size=0},delete:function(e){var t=C(this),r=k(this,e);if(r){var o=r.next,n=r.previous;delete t.index[r.index],r.removed=!0,n&&(n.next=o),o&&(o.previous=n),t.first==r&&(t.first=o),t.last==r&&(t.last=n),v?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=C(this),o=c(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(o(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!k(this,e)}}),l(f.prototype,r?{get:function(e){var t=k(this,e);return t&&t.value},set:function(e,t){return w(this,0===e?0:e,t)}}:{add:function(e){return w(this,e=0===e?0:e,e)}}),v&&o(f.prototype,"size",{get:function(){return C(this).size}}),f},setStrong:function(e,t,r){var o=t+" Iterator",n=S(t),l=S(o);h(e,t,(function(e,t){y(this,{type:o,target:e,state:n(e),kind:t,last:void 0})}),(function(){for(var e=l(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),f(t)}}},1308:function(e,t,r){"use strict";var o=r(1301),n=r(1303);e.exports=o("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n)},1309:function(e,t,r){"use strict";r(86);t.a={data:function(){return{rules:{name:[{required:!0,message:this.$t("请输入名称"),trigger:"blur"}]}}}}},1311:function(e,t,r){"use strict";r.r(t);r(237),r(709),r(179);var o,n=r(104),l=r(1265),c=r(7),m=r(1269),d=r(1257),h=r(6),f={name:"studentTreeAndListNoPage",components:(o={MyRadio:m.default,MyCascader:l.default},Object(n.a)(o,"MyRadio",m.default),Object(n.a)(o,"MyInputButton",d.default),o),props:{selValue:{default:"",type:[String,Array]},selArr:{default:function(){return[]},type:Array},setType:{default:"radio",type:[String,Number]},userType:{default:"",type:String},groupId:{default:"",type:[String,Number]},maxHeight:{default:"300",type:[String,Number]}},computed:{_selValue:function(){this.commSelUserVal=this.selValue},_selArr:function(){}},data:function(){return{commAllCheck:!1,commAllCheckCount:0,value:"",commPage:1,commNum:20,commTotalTotal:0,tableTeacherCommData:[],searchCommDeptData:[],commSex:"",commSearchKey:"",commSearchDept:"",commSearchCollege:"",commSearchMajor:"",commSearchGrade:"",commSearchClass:"",commSelUserVal:"",commSelUserArr:[],commSelUserNameArr:[],commSelUserTempArr:[],commSelUserValObj:{},commSelUserValArr:[],commLoading:!1,commFlag:!1,commMultipleSelection:[],commRow:"",commGetRowKeys:function(e){return e.user_id}}},created:function(){},methods:{_initTeacher:function(){var e=this;this.checkboxCount=0;var t={page:this.commPage,num:this.commNum,deleted:0,sex:this.commSex.sex,collegeId:this.commSearchCollege,majorId:this.commSearchMajor,grade:this.commSearchGrade,clasz:this.commSearchClass,groupId:this.groupId};this.commLoading=!0,t.realName=this.commSearchKey.input,this.$axios.get(c.a.dormaccess_student_select_status_page,{params:t}).then((function(t){if(t.data.data){for(var i=0;i<t.data.data.list.length;i++){Object(h.u)(t.data.data.list[i],e.commSelUserArr,"user_id")>-1?(e.commFlag=!0,t.data.data.list[i]._checked=!0,e.checkboxCount++):t.data.data.list[i]._checked=!1}0!=e.checkboxCount&&e.checkboxCount==e.tableTeacherCommData.length?e.commAllCheck=!0:e.commAllCheck=!1,e.commFlag=!1,e.tableTeacherCommData=t.data.data.list,e.commTotalTotal=t.data.data.totalCount,e.commNum=t.data.data.num,e.commPage=t.data.data.currentPage}e.commLoading=!1}))},_handleOpen:function(e){this.commPage=1,this.commNum=20,this.commSex=e||"",this.commSelUserArr=this.selArr,this._initTeacher()},_handleChange:function(data,e){this.commSelUserVal=data.user_id,this.commSelUserValObj=data,this.$emit("change",data)},_handleCascaderChange:function(data){this.commSearchCollege="",this.commSearchMajor="",this.commSearchGrade="",this.commSearchClass="",1==data.length?this.commSearchCollege=data[0]:2==data.length?(this.commSearchCollege=data[0],this.commSearchMajor=data[1]):3==data.length?(this.commSearchCollege=data[0],this.commSearchMajor=data[1],this.commSearchGrade=data[2]):4==data.length&&(this.commSearchCollege=data[0],this.commSearchMajor=data[1],this.commSearchGrade=data[2],this.commSearchClass=data[3]),this.commPage=1,this._initTeacher()},_handleSelectionSelect:function(e,t){if(e)this.commSelUserArr.push(t),t._checked=!0,this.checkboxCount++;else{var r=Object(h.u)(t,this.commSelUserArr,"user_id");this.commSelUserArr.splice(r,1),t._checked=!1,this.checkboxCount--}0!=this.checkboxCount&&this.checkboxCount==this.tableTeacherCommData.length?this.commAllCheck=!0:this.commAllCheck=!1,this.$emit("select",this.commSelUserArr)},_handleSelectionAllSelect:function(e){this.commAllCheck=e;for(var i=0;i<this.tableTeacherCommData.length;i++)if(1==e){this.tableTeacherCommData[i]._checked=!0,-1==Object(h.u)(this.tableTeacherCommData[i],this.commSelUserArr,"user_id")&&this.commSelUserArr.push(this.tableTeacherCommData[i]),this.checkboxCount++}else{var t=Object(h.u)(this.tableTeacherCommData[i],this.commSelUserArr,"user_id");this.commSelUserArr.splice(t,1),this.tableTeacherCommData[i]._checked=!1,this.checkboxCount--}this.$emit("select",this.commSelUserArr)},_handleSelectionChange:function(data){},_handleSizeChange:function(data){this.commPage=1,this.commNum=data,this._initTeacher()},_handleCurrentChange:function(data){this.commPage=data,this._initTeacher()},_handleResetChange:function(){this.value="",this.commNum=20,this.commPage=1,this.searchCommDeptData=[],this.commSearchKey="",this.commSearchDept="",this.commSelUserVal="",this.commSelUserValObj={},this.commSelUserValArr=[],this.commSelUserArr=[],this.$refs.SelectorDept&&this.$refs.SelectorDept.$refs.cascaderSelector&&this.$refs.SelectorDept.$refs.cascaderSelector.$refs.panel.calculateCheckedNodePaths(),this.$refs.SelectorDept&&this.$refs.SelectorDept.$refs.cascaderSelector&&this.$refs.SelectorDept.$refs.cascaderSelector.$refs.panel.calculateCheckedNodePaths()},_handleSelect:function(){this.commFlag=!0;for(var e=[],t=[].concat(this.tableTeacherCommData),r=[].concat(this.selArr),i=0;i<t.length;i++){Object(h.u)(t[i],r,"user_id")>-1&&(e.push(t[i]),this.$refs.commTableRef.toggleRowSelection(t[i],!0))}this.commSelUserTempArr=e,this.commFlag=!1},_handleSearch:function(data){this.commSearchKey=data,this.commPage=1,this._initTeacher()},_getSelectData:function(){this.$emit("select",this.commSelUserArr)},_selectBedno:function(e){var t=this,r={bedNo:this.commSex.bedNo,dromId:this.commSex.dormId,studentId:e.user_id,majorClassId:e.clasz};r=this.$qs.stringify(r),this.$axios.post(c.a.dorm_user_class_bed_distribute,r).then((function(e){e.data.data?(t._initTeacher(),Object(h.b)(e.data.desc),t.$emit("distribute",e.data.data)):Object(h.c)(e.data.desc)}))}}},v=r(10),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"commTeacherList"},[r("div",{staticClass:"layout-inline"},[r("my-cascader",{ref:"SelectorDept",staticClass:"layout-item",attrs:{size:"small","width-style":"160","sel-value":e.searchCommDeptData,type:"1","sub-type":"4"},on:{change:function(t){return e._handleCascaderChange(t)}}}),e._v(" "),r("my-input-button",{staticClass:"layout-item",attrs:{size:"small",clearable:!0,type:"success",plain:""},on:{click:e._handleSearch}})],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.commLoading,expression:"commLoading"}],ref:"commTableRef",attrs:{data:e.tableTeacherCommData,"max-height":e.maxHeight,size:"mini"}},["select"==e.setType?r("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==t.row.bed_no?r("a",{staticClass:"color-grand",attrs:{href:"javascript:;"},on:{click:function(r){return e._selectBedno(t.row)}}},[e._v(e._s(e.$t("分配")))]):r("label",{staticClass:"color-warning"},[e._v(e._s(e.$t("已分配")))])]}}],null,!1,3111910370)}):e._e(),e._v(" "),"check"==e.setType?r("el-table-column",{attrs:{align:"center",width:"55"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("el-checkbox",{on:{change:e._handleSelectionAllSelect},model:{value:e.commAllCheck,callback:function(t){e.commAllCheck=t},expression:"commAllCheck"}})]}},{key:"default",fn:function(t){return[r("el-checkbox",{on:{change:function(r){return e._handleSelectionSelect(r,t.row)}},model:{value:t.row._checked,callback:function(r){e.$set(t.row,"_checked",r)},expression:"scope.row._checked"}})]}}],null,!1,1304403255)}):e._e(),e._v(" "),"radio"==e.setType?r("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("my-radio",e._b({attrs:{"sel-value":e.commSelUserVal,label:t.row.user_id},on:{change:function(r){return e._handleChange(t.row)}}},"my-radio",e._selValue,!1),[r("span")])]}}],null,!1,4043958644)}):e._e(),e._v(" "),r("el-table-column",{attrs:{property:"real_name",align:"center",label:"姓名"}}),e._v(" "),r("el-table-column",{attrs:{property:"student_id",align:"center",label:"学号"}}),e._v(" "),r("el-table-column",{attrs:{property:"",align:"center",label:"班级"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[r("div",{staticClass:"text-center"},[e._v(e._s(t.row.class_name?t.row.class_name:"--"))]),e._v(" "),r("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[e._v("\n            "+e._s(t.row.class_name?t.row.class_name:"--")+"\n          ")])])]}}])})],1),e._v(" "),r("div",{staticClass:"text-right margin-top-10"},[r("el-pagination",{attrs:{"current-page":e.commPage,"page-sizes":[10,20,30,50,100],"page-size":e.commNum,layout:"total, sizes, prev, pager, next",total:e.commTotalTotal},on:{"size-change":e._handleSizeChange,"current-change":e._handleCurrentChange}})],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{MyCascader:r(1265).default,MyInputButton:r(1257).default,MyRadio:r(1269).default})},1317:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r(242);var n=r(366);function l(e){return function(e){if(Array.isArray(e))return Object(o.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(n.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1396:function(e,t,r){var content=r(1700);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(31).default)("3f7132e4",content,!0,{sourceMap:!1})},1699:function(e,t,r){"use strict";var o=r(1396);r.n(o).a},1700:function(e,t,r){(t=r(30)(!1)).push([e.i,".container[data-v-448aed18]{padding:10px 15px}.title-block-tag[data-v-448aed18]{display:inline-block;height:20px;width:3px;background:#e6a23c;font-weight:700;border-radius:3px}.title-block-text[data-v-448aed18]{font-weight:700;position:relative;top:-5px}.block-item-bg[data-v-448aed18]{border-radius:5px;background:#fff;padding:10px}",""]),e.exports=t},2033:function(e,t,r){"use strict";r.r(t);r(237),r(360),r(65),r(43),r(106),r(1308),r(137),r(710),r(136),r(107);var o=r(1317),n=r(76),l=r(1261),c=r(1257),m=r(234),d=r(235),h=r(1260),f=r(1268),v=r(7),_=r(6),C=r(236),y=r(1309),S=r(1265),w={mixins:[n.a,y.a],components:{MyCascader:S.default,DrawerLayoutRight:C.default,LayoutTb:l.default,MyInputButton:c.default,MyPagination:m.default,DialogNormal:d.default,MyNormalDialog:h.default,DrawerRight:f.default},data:function(){return{drawerVisible:!1,drawerLoading:!1,visibleConfim:!1,dialogLoading:!1,btnLoading:!1,refreshTeacherStatus:!1,refreshStudentStatus:!1,tableData:[],searchKey:"",teacherArray:[],approverUsers:[],roleList:[],errorTeacher:"",roleOptions:[],form:{id:"",name:"",des:"",roleType:0,roleOprLook:!1,roleOprDel:!1,roleOprSubmit:!1,roleOprImOrEx:!1,roleTeachers:!1,roleStudents:!1,roleUsers:[],roleUserGroup:[],enable:!0,permissionContent:"",permissionContentArray:[],approverTeacherId:[],approverStudentId:[],roleList:[]}}},created:function(){this.init()},methods:{init:function(){var e=this,t={page:this.page,num:this.num,searchKey:this.searchKey};this.$axios.get(v.a.server_form_template_permission_list,{params:t}).then((function(t){t.data.data&&(e.tableData=t.data.data.list,e.total=t.data.data.totalCount,e.num=t.data.data.num,e.page=t.data.data.currentPage)}))},addInitData:function(e){this.drawerVisible=!0},editInfo:function(data){this.form={id:data.id,name:data.permission_name,des:data.des,roleType:data.permission_type,roleOprLook:data.permission_condition1,roleOprDel:data.permission_condition2,roleOprSubmit:!1,roleOprImOrEx:data.permission_condition3,roleTeachers:data.permission_teacher_switch,roleStudents:data.permission_student_switch,roleUsers:[],roleUserGroup:[],enable:!0,permissionContent:data.permission_content,roleList:data.role_content&&""!=data.role_content?JSON.parse(data.role_content):[]};var e=[];if(this.form.permissionContentArray=[],this.approverUsers=[],""!=data.permission_content){this.approverUsers=data.permission_content.split(","),e=data.permission_content.split(",");for(var i=0;i<e.length;i++)this.form.permissionContentArray.push({user_id:e[i]})}this.drawerVisible=!0},deleteInfo:function(e){this.form.id=e.id,this.visibleConfim=!0},sizeChange:function(e){this.page=1,this.num=e,this.init()},currentPage:function(e){this.page=e,this.init()},jumpPage:function(data){this.page=data,this.init()},search:function(data){this.searchKey=data.input,this.page=1,this.init()},changeFormType:function(data){this.approverUsers=[],this.form.permissionContentArray=[],this.form.roleUsers=[],this.form.approverTeacherId=[],this.form.approverStudentId=[],this.form.roleType=data},changeFormOprLook:function(data){this.form.roleOprLook=data},changeFormOprDel:function(data){this.form.roleOprDel=data},changeFormOprSubmit:function(data){this.form.roleOprSubmit=data},changeFormTeacher:function(data){this.form.roleTeachers=data},changeFormStudent:function(data){this.form.roleStudents=data},handleCascaderChange:function(data){console.log(data),this.form.roleList=data},loadingShow:function(e){var t=this,r=null;switch(clearTimeout(r),e){case 1:this.refreshTeacherStatus=!0,r=setTimeout((function(){t.refreshTeacherStatus=!1,clearTimeout(r)}),1e3);break;case 2:this.refreshStudentStatus=!0,r=setTimeout((function(){t.refreshStudentStatus=!1,clearTimeout(r)}),1e3)}},handleShowTeacher:function(e){var t=this;setTimeout((function(){1==e?t.$refs.popverTeacherRef._handleOpen():2==e&&t.$refs.popverStudentRef._handleOpen()}),800)},handleSelUser:function(data,e){if(1==e){this.form.approverTeacherId=data;var t=this.form.approverStudentId?this.form.approverStudentId:[];this.form.roleUsers=t.concat(this.form.approverTeacherId)}else if(2==e){this.form.approverStudentId=data;var r=this.form.approverTeacherId?this.form.approverTeacherId:[];this.form.roleUsers=r.concat(this.form.approverStudentId)}this.form.roleUsers=Object(o.a)(new Set(this.form.roleUsers)),this.approverUsers=this.form.roleUsers},openedDialog:function(){this.$refs.SelectorDept&&this.$refs.SelectorDept.initInfo()},closeDrawerDialog:function(e){this.closeDialog(),this.drawerVisible=!1},cancelDrawDialog:function(){this.drawerVisible=!1},closeDialog:function(e){this.form={id:"",name:"",des:"",roleType:0,roleOprLook:!1,roleOprDel:!1,roleOprSubmit:!1,roleOprImOrEx:!1,roleTeachers:!1,roleStudents:!1,roleUsers:[],roleUserGroup:[],enable:!0,permissionContent:"",permissionContentArray:[],approverTeacherId:[],approverStudentId:[],roleList:[]},this.errorTeacher="",this.teacherArray=[],this.approverUsers=[],this.resetCasadeSelector("selectorDept"),this.$refs.form&&this.$refs.form.resetFields()},handleOkChange:function(data){var e=this;this.dialogLoading=!0;var t,r={id:this.form.id};t=v.a.server_form_template_permission_del,r=this.$qs.stringify(r),this.$axios.post(t,r).then((function(t){200==t.data.code?(e.init(),Object(_.b)(t.data.desc)):Object(_.a)(t.data.desc),e.visibleConfim=!1,e.dialogLoading=!1}))},handleCancelChange:function(data){this.visibleConfim=!1},okDrawDialog:function(e){var t=this,r="";this.$refs.formRole.validate((function(e){if(e){for(var o=[],i=0;i<t.form.roleList.length;i++)2==t.form.roleList[i].length&&o.push(t.form.roleList[i]);for(var n={permissionType:t.form.roleType,permissionCondition1:t.form.roleOprLook,permissionCondition2:t.form.roleOprDel,permissionCondition3:t.form.roleOprImOrEx,permissionStudentSwitch:t.form.roleStudents,permissionTeacherSwitch:t.form.roleTeachers,permissionName:t.form.name,enable:t.form.enable,des:t.form.des,roleContent:o.length>0?JSON.stringify(o):""},l=[],c=0;c<t.form.permissionContentArray.length;c++)l.push(t.form.permissionContentArray[c].user_id);n.permissionContent=l.join(),""!=t.form.id&&(n.id=t.form.id),r=v.a.server_form_template_permission_save,n=t.$qs.stringify(n),t.btnLoading=!0,t.$axios.post(r,n,{loading:!1}).then((function(e){200==e.data.code?(t.drawerVisible=!1,t.init(),Object(_.b)(e.data.desc)):Object(_.a)(e.data.desc),t.btnLoading=!1}))}}))}}},k=(r(1699),r(10)),component=Object(k.a)(w,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("layout-tb",[r("template",{slot:"tag"},[e._v("权限管理")]),e._v(" "),r("div",{attrs:{slot:"tab"},slot:"tab"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addInitData(t)}}},[e._v(e._s(e.$t("添加权限组")))])],1),e._v(" "),r("el-col",{staticClass:"text-right",attrs:{span:12}},[r("MyInputButton",{attrs:{size:"small",plain:"","width-class":"width: 150px",type:"success",clearable:!0,placeholder:e.$t("名称")},on:{click:e.search}})],1)],1)],1),e._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("el-table",{ref:"refTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"custom-table-cell-bg",size:"medium","row-key":"id","max-height":e.tableHeight.height}},[r("el-table-column",{attrs:{align:"center",prop:"id",label:e.$t("编号")}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"permission_name",label:e.$t("名称")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[r("div",{staticClass:"text-center"},[e._v(e._s(t.row.permission_name))]),e._v(" "),r("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[r("span",[e._v(e._s(t.row.permission_name))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("创建时间")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.$moment(t.row.create_time).format("YYYY-MM-DD HH:mm")))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("描述")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"top","popper-class":"custom-table-popover"}},[r("div",{staticClass:"text-center"},[e._v(e._s(t.row.des?t.row.des:"--"))]),e._v(" "),r("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[r("span",[e._v(e._s(t.row.des?t.row.des:"--"))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("被引用表单")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"left"}},[r("div",{staticClass:"text-center"},[""!=t.row.form_name&&null!=t.row.form_name?r("div",{staticStyle:{"max-height":"200px","overflow-y":"auto"}},e._l(t.row.form_name.split(","),(function(t,o){return r("div",{key:o},[r("span",{staticClass:"font-size-12"},[e._v(e._s(t))])])})),0):r("div",[e._v("--")])]),e._v(" "),r("div",{staticClass:"name-wrapper moon-content-text-ellipsis-class",attrs:{slot:"reference"},slot:"reference"},[r("span",[e._v(e._s(t.row.form_name?t.row.form_name:"--"))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"fa fa-edit margin-right-5 color-grand",on:{click:function(r){return e.editInfo(t.row)}}}),e._v(" "),r("i",{staticClass:"fa fa-trash color-danger",on:{click:function(r){return e.deleteInfo(t.row)}}})]}}])})],1),e._v(" "),r("div",{staticClass:"layout-right-footer text-right"},[r("my-pagination",{staticClass:"layout-pagination",attrs:{total:e.total,"current-page":e.page,"page-size":e.num},on:{currentPage:e.currentPage,sizeChange:e.sizeChange,jumpChange:e.jumpPage}})],1)],1)],2),e._v(" "),r("drawer-layout-right",{attrs:{visible:e.drawerVisible,size:"450px",title:e.$t("角色设置")},on:{changeDrawer:e.closeDrawerDialog,opened:e.openedDialog,"right-close":e.cancelDrawDialog}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("div",[r("div",{staticClass:"color-muted margin-top-5"},[r("span",[r("label",{staticClass:"title-block-tag"}),e._v(" "),r("label",{staticClass:"title-block-text color-warning"},[e._v(e._s(e.$t("权限设置")))])])]),e._v(" "),r("div",{staticClass:"block-item-bg font-size-12"},[r("el-form",{ref:"formRole",attrs:{model:e.form,rules:e.rules,"label-width":"60px"}},[r("el-form-item",{attrs:{label:e.$t("名称"),prop:"name"}},[r("el-input",{staticClass:"width-300",attrs:{size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("描述")}},[r("el-input",{staticClass:"width-300",attrs:{type:"textarea",row:"3",size:"small"},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1)],1)],1)]),e._v(" "),r("div",{staticClass:"margin-top-20"},[r("div",{staticClass:"color-muted margin-top-5"},[r("span",[r("label",{staticClass:"title-block-tag"}),e._v(" "),r("label",{staticClass:"title-block-text color-warning"},[e._v(e._s(e.$t("权限类型")))])])]),e._v(" "),r("div",{staticClass:"block-item-bg font-size-12",staticStyle:{position:"relative",padding:"20px 10px !important"}},[r("div",[r("el-radio-group",{on:{change:e.changeFormType},model:{value:e.form.roleType,callback:function(t){e.$set(e.form,"roleType",t)},expression:"form.roleType"}},[r("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("表单使用")))]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("数据统计")))])],1)],1)])]),e._v(" "),1===e.form.roleType?r("div",{staticClass:"margin-top-20"},[r("div",{staticClass:"color-muted margin-top-5"},[r("span",[r("label",{staticClass:"title-block-tag"}),e._v(" "),r("label",{staticClass:"title-block-text color-warning"},[e._v(e._s(e.$t("操作权限")))])])]),e._v(" "),r("div",{staticClass:"block-item-bg font-size-12",staticStyle:{position:"relative"}},[r("div",[r("el-checkbox",{on:{change:e.changeFormOprLook},model:{value:e.form.roleOprLook,callback:function(t){e.$set(e.form,"roleOprLook",t)},expression:"form.roleOprLook"}},[r("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("查看")))])]),e._v(" "),r("el-checkbox",{on:{change:e.changeFormOprDel},model:{value:e.form.roleOprDel,callback:function(t){e.$set(e.form,"roleOprDel",t)},expression:"form.roleOprDel"}},[r("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("删除")))])]),e._v(" "),r("el-checkbox",{on:{change:e.changeFormOprSubmit},model:{value:e.form.roleOprImOrEx,callback:function(t){e.$set(e.form,"roleOprImOrEx",t)},expression:"form.roleOprImOrEx"}},[r("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("导入导出")))])])],1)])]):e._e(),e._v(" "),r("div",{staticClass:"margin-top-20"},[r("div",{staticClass:"color-muted margin-top-5"},[r("span",[r("label",{staticClass:"title-block-tag"}),e._v(" "),r("label",{staticClass:"title-block-text color-warning"},[e._v(e._s(e.$t("权限成员")))])])]),e._v(" "),r("div",{staticClass:"block-item-bg font-size-12",staticStyle:{position:"relative"}},[r("div",[r("div",[r("span",[e._v(e._s(e.$t("成员范围"))+": ")])]),e._v(" "),r("div",{staticClass:"margin-top-5"},[r("el-checkbox",{on:{change:e.changeFormStudent},model:{value:e.form.roleStudents,callback:function(t){e.$set(e.form,"roleStudents",t)},expression:"form.roleStudents"}},[r("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("所有学生")))])]),e._v(" "),r("el-checkbox",{on:{change:e.changeFormTeacher},model:{value:e.form.roleTeachers,callback:function(t){e.$set(e.form,"roleTeachers",t)},expression:"form.roleTeachers"}},[r("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("所有老师")))])])],1)]),e._v(" "),r("div",{staticClass:"margin-top-10"},[r("div",[r("span",[e._v(e._s(e.$t("组织范围"))+": ")])]),e._v(" "),r("div",{staticClass:"margin-top-10"},[r("el-popover",{attrs:{"popper-class":"custom-popper-class-form",placement:"top",width:"700",trigger:"click"},on:{show:function(t){return e.handleShowTeacher(1)}}},[r("div",[r("teacher-tree-and-list-no-page",{ref:"popverTeacherRef",attrs:{"user-type":"user","group-id":e.form.id,"sel-arr":e.form.permissionContentArray,"set-type":"check"},on:{select:function(t){return e.handleSelUser(t,1)}}})],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"success",plain:"",size:"small"},on:{click:function(t){return e.loadingShow(1)}},slot:"reference"},[1==e.refreshTeacherStatus?r("i",{staticClass:"fa fa-refresh fa-spin"}):e._e(),e._v("\n                  "+e._s(e.$t("教师"))+"\n                ")])],1),e._v(" "),r("el-popover",{attrs:{"popper-class":"custom-popper-class-form",placement:"top",width:"700",trigger:"click"},on:{show:function(t){return e.handleShowTeacher(2)}}},[r("div",[r("student-tree-and-list-no-page",{ref:"popverStudentRef",attrs:{"group-id":e.form.id,"sel-arr":e.form.permissionContentArray,"set-type":"check"},on:{select:function(t){return e.handleSelUser(t,2)}}})],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"success",plain:"",size:"small"},on:{click:function(t){return e.loadingShow(2)}},slot:"reference"},[1==e.refreshStudentStatus?r("i",{staticClass:"fa fa-refresh fa-spin"}):e._e(),e._v("\n                  "+e._s(e.$t("学生"))+"\n                ")])],1),e._v(" "),r("span",[e._v(e._s(e.$t("人数"))+": "+e._s(e.approverUsers.length))])],1)])])]),e._v(" "),r("div",{staticClass:"margin-top-20"},[r("div",{staticClass:"color-muted margin-top-5"},[r("span",[r("label",{staticClass:"title-block-tag"}),e._v(" "),r("label",{staticClass:"title-block-text color-warning"},[e._v(e._s(e.$t("角色选择")))])])]),e._v(" "),r("div",{staticClass:"block-item-bg font-size-12",staticStyle:{position:"relative"}},[r("my-cascader",{ref:"SelectorDept",staticClass:"layout-item",attrs:{clearable:!0,props:{multiple:!0},size:"small","width-style":"300","sel-value":e.form.roleList,type:"5","sub-type":""},on:{change:function(t){return e.handleCascaderChange(t)}}})],1)])]),e._v(" "),r("div",{staticClass:"padding-lr-10",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.cancelDrawDialog}},[e._v(e._s(e.$t("取消")))]),e._v(" "),r("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:function(t){return e.okDrawDialog()}}},[e._v("\n        "+e._s(e.$t("确定"))+"\n      ")])],1)]),e._v(" "),r("my-normal-dialog",{attrs:{visible:e.visibleConfim,loading:e.dialogLoading,title:"提示",content:"确认需要删除该信息？"},on:{"update:visible":function(t){e.visibleConfim=t},"ok-click":e.handleOkChange,"cancel-click":e.handleCancelChange,close:e.closeDialog}})],1)}),[],!1,null,"448aed18",null);t.default=component.exports;installComponents(component,{MyInputButton:r(1257).default,MyPagination:r(234).default,LayoutTb:r(1261).default,TeacherTreeAndListNoPage:r(1305).default,StudentTreeAndListNoPage:r(1311).default,MyCascader:r(1265).default,DrawerLayoutRight:r(236).default,MyNormalDialog:r(1260).default})}}]);